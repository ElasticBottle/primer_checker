(this.webpackJsonpprimer_checker=this.webpackJsonpprimer_checker||[]).push([[0],{326:function(e,t,a){e.exports=a(692)},331:function(e,t,a){},333:function(e,t,a){},337:function(e,t,a){},338:function(e,t,a){},339:function(e,t,a){},357:function(e,t,a){},360:function(e,t,a){},376:function(e,t,a){},381:function(e,t,a){},686:function(e,t,a){},688:function(e,t,a){},692:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(37),l=a.n(s),o=(a(331),a(11)),c=a(90),i=a(28),u=a(29),m=a(20),d=a(24),p=a(35),f=a(40),g=a(75),b=a(210),h=a(111),v=a(53),E=a(77),y=a.n(E),O=a(167),x=(a(333),function(e){return null!==/^>fwd[\s\S]{2}[ACGTacgt]+[\s\S]{1,2}>rev[\s\S]{1,2}[ACGTacgt]+[\s\S]{1,2}>prb[\s\S]{1,2}[ACGTacgt]+[\s\S]{1,2}$/.exec(e)});var w=function(e){var t=e.selectedFiles,a=e.setSelectedFiles,n=e.setErrorMessage,s=function(){var e=Object(O.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files,e.next=3,l(a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(O.a)(y.a.mark((function e(n){var r,s,l,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],s=Object(v.a)(n),e.prev=2,s.s();case 4:if((l=s.n()).done){e.next=13;break}return c=l.value,e.t0=r,e.next=9,o(c);case 9:e.t1=e.sent,r=e.t0.concat.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),s.e(e.t2);case 18:return e.prev=18,s.f(),e.finish(18);case 21:a(t.concat.apply(t,Object(u.a)(r)));case 22:case"end":return e.stop()}}),e,null,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(O.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(t);case 3:return a=e.sent,e.abrupt("return",a);case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),c=function(e){var t=new FileReader;return console.log(e),new Promise((function(a,r){t.onload=function(t){x(t.target.result)?(e.invalid=!1,e.content=t.target.result,e.id=e.name):(console.log("file loaded but invalid format"),n("File not a recognized format. Please check"),e.invalid=!0),a(e)},t.onerror=function(){t.abort(),r(new DOMException("Problem parsing input file."))},t.readAsText(e,"UTF-8")}))};return r.a.createElement(m.a.Group,{controlId:"fasta-sequence"},r.a.createElement("label",{htmlFor:"fasta-input",id:"fasta-input-label"},r.a.createElement(f.a,{className:"drop-container",onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault()},onDragLeave:function(e){e.preventDefault()},onDrop:function(e){e.preventDefault();var t=e.dataTransfer.files;l(t)}},r.a.createElement("div",{className:"drop-message"},r.a.createElement("div",{className:"upload-icon"}),"Drag & Drop files here or click to upload"),r.a.createElement("input",{className:"file-input",id:"fasta-input",type:"file",onChange:s,multiple:!0}))))},S=(a(337),a(13)),k=function(e){var t=e.setTextFieldFasta,a=Object(n.useState)(""),s=Object(o.a)(a,2),l=s[0],c=s[1],i=Object(n.useState)(""),u=Object(o.a)(i,2),f=u[0],g=u[1],b=">fwd\nGTGAAATGGTCATGTGTGGCGG\n>rev\nTATGCTAATAGTGTTTTTAACATTTG\n>prb\nCAGGTGGAACCTCATCAGGAGATGC";Object(n.useEffect)((function(){x(f)?(console.log("sequence oKAY!",f),t([{invalid:!1,content:f,id:"text_input_fasta"}])):(console.log("Nope"),t([]),c("Sequence not recognized! Please check."))}),[f,t]);return r.a.createElement(m.a.Group,{controlId:"fasta-sequence"},r.a.createElement(d.a,{className:"fasta-input-header"},r.a.createElement(S.a,null,r.a.createElement(m.a.Label,{className:"fasta-input-title"},"Fasta Sequence")),r.a.createElement(S.a,{className:"sample-fasta"},r.a.createElement(p.a,{variant:"secondary",size:"sm",onClick:function(){g(b)}},"Sample Input"))),r.a.createElement(m.a.Control,{as:"textarea",placeholder:"Input Fasta Seq here.",onChange:function(e){var t=e.target.value;g(t)},type:"text",value:f,className:"mx-sm-lg-auto","aria-describedby":"fastaSequenceHelpBlock"}),r.a.createElement(m.a.Text,{id:"fastaSequenceHelpBlock",muted:!0},"Format for the primer sequence should be as follows:",r.a.createElement("br",null),r.a.createElement("strong",null,b.split("\n").map((function(e,t){return r.a.createElement("p",{key:t},e)})))),r.a.createElement(m.a.Control.Feedback,{type:"invalid"},l))},C=(a(338),a(339),a(49)),T=function(e){var t=e.show,a=e.handleClose,n=e.content;return r.a.createElement(C.a,{show:t,onHide:a},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,"Fasta Primer Preview")),r.a.createElement(C.a.Body,null,function(e){for(var t=Object(u.a)(e.matchAll(/\s+/g)),a=[],n=0;n<t.length;n++)a=0===n?a.concat(e.slice(0,t[0].index)):a.concat(e.slice(t[n-1].index+1,t[n].index));return a}(n).map((function(e,t){return r.a.createElement("p",{key:t},e)}))),r.a.createElement(C.a.Footer,null,r.a.createElement(p.a,{variant:"primary",onClick:a},"Close")))},D=function(e){var t=e.file,a=e.errorMessage,s=e.setSelectedFiles,l=Object(n.useState)(""),c=Object(o.a)(l,2),i=c[0],u=c[1],m=Object(n.useState)(!1),g=Object(o.a)(m,2),b=g[0],h=g[1],v=function(e){s((function(t){return t.filter((function(t){return t.name!==e}))}))};return r.a.createElement(f.a,{className:"file-status-bar"},r.a.createElement(d.a,null,r.a.createElement("div",{className:"file-type-logo"}),r.a.createElement("div",{className:"file-type"},function(e){var t=e.substring(e.lastIndexOf(".")+1,e.length);return t.length===e.length?"Fasta":t}(t.name)),r.a.createElement(S.a,{lg:5,md:12,className:"file-info"},r.a.createElement("div",{className:"file-name ".concat(t.invalid?"file-error":""),onClick:t.invalid?function(){return v(t.name)}:function(){return function(e){u(e.content),h(!0)}(t)}},t.name),r.a.createElement("div",{className:"file-size"},"(",function(e){if(0===e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][t]}(t.size),")")),r.a.createElement(S.a,{lg:4,md:8,className:"file-error-message"},t.invalid?r.a.createElement("div",{className:"file-error-message-text"},"(",a,")"):null),r.a.createElement(S.a,{lg:2,md:2,className:"file-remove"},r.a.createElement(p.a,{onClick:function(){return v(t.name)},variant:"danger",size:"sm"},"Remove"))),r.a.createElement(T,{show:b,handleClose:function(){return h(!1)},content:i}))},j=a(207),B=a.n(j),N=function(e){var t={data:e};return B.a.post("".concat("http://localhost:3001","/check_primers"),t)},M=(a(357),function(e){var t=e.setResults,a=Object(n.useState)(!1),s=Object(o.a)(a,2),l=s[0],c=s[1],v=Object(n.useState)([]),E=Object(o.a)(v,2),y=E[0],O=E[1],x=Object(n.useState)([]),S=Object(o.a)(x,2),C=S[0],T=S[1],j=Object(n.useState)([]),B=Object(o.a)(j,2),M=B[0],A=B[1],F=Object(n.useState)([]),I=Object(o.a)(F,2),_=I[0],P=I[1],G=Object(n.useState)(""),z=Object(o.a)(G,2),L=z[0],R=z[1],H=Object(n.useState)(""),V=Object(o.a)(H,2),q=V[0],J=V[1],U=Object(n.useState)(!0),W=Object(o.a)(U,2),K=W[0],Y=W[1],Z=Object(n.useState)(!1),$=Object(o.a)(Z,2),Q=$[0],X=$[1],ee=Object(i.f)(),te="open-containers";Object(n.useEffect)((function(){var e=y.reduce((function(e,t){return e.find((function(e){return e.name===t.name}))?e:e.concat(t)}),[]);T(Object(u.a)(e))}),[y]),Object(n.useEffect)((function(){var e=C.reduce((function(e,t){return t.invalid?e:e.concat(t)}),[]);A(e)}),[C]),Object(n.useEffect)((function(){if(M.length===C.length&&0!==M.length&&0===_.length||0!==_.length&&0===M.length)return console.log(M),J(""),c(!0);0!==_.length&&0!==M.length&&(c(!1),J("Either upload a single sequence through input or select files to upload! Not Both!")),c(!1)}),[M,C,_]);return r.a.createElement("div",null,r.a.createElement(g.a,{id:te,in:K},r.a.createElement("div",{className:"collapse-container"},r.a.createElement(f.a,null,r.a.createElement(m.a,{noValidate:!0},r.a.createElement(k,{setTextFieldFasta:P}),r.a.createElement("p",{className:"alternative-upload"},"OR"),r.a.createElement(w,{selectedFiles:y,setSelectedFiles:O,setErrorMessage:R})),r.a.createElement(f.a,{className:"file-display-container"},C.map((function(e,t){return r.a.createElement(D,{file:e,errorMessage:L,setSelectedFiles:O,key:t})})))))),r.a.createElement(f.a,null,r.a.createElement(d.a,{className:"upload-error-message"},q),l?r.a.createElement(h.a,{in:K},r.a.createElement(p.a,{id:te,"aria-controls":te,"aria-expanded":K,onClick:function(){console.log(M,_),Y(!K),X(!0),setTimeout((function(){N(0===M.length?_:M).then((function(e){c(!1),O([]),P([]),R(""),J(""),X(!1),console.log("response is",e),t(JSON.stringify(e.data)),ee.push("/results/Overview")})).catch((function(e){return console.log(e)}))}),500)},disabled:Q},Q?r.a.createElement(b.a,{as:"span",className:"loader",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):null,Q?"Loading...":"Submit")):null,Q?r.a.createElement(h.a,{in:!K},r.a.createElement(f.a,{className:"loading-container"},r.a.createElement(b.a,{id:te,as:"span",animation:"border",role:"status",variant:"dark"}))):null))}),A=(a(360),a(16)),F=a(165),I=a(31),_=a(318),P=a.n(_),G=a(323),z=a(322),L=Object(z.a)();var R=function(e){var t=e.onChange,a=e.options,n=e.placeholder,s=e.isLoading,l=void 0!==s&&s,o=e.defaultValue,c=void 0===o?[]:o;return r.a.createElement(G.a,{closeMenuOnSelect:!1,components:L,defaultValue:c,isMulti:!0,isSearchable:!0,isClearable:!0,isLoading:l,placeholder:n,onChange:t,options:a})};var H=function(e){var t=e.data,a=e.id,n=e.value,s=e.minVal,l=e.maxVal,c=e.step,i=e.setFilter,d=r.a.useMemo((function(){var e=Object.values(t).reduce((function(e,t){return e.push.apply(e,Object(u.a)(t)),e}),[]),n=e.length?e[0][a]:0,r=e.length?e[0][a]:0;return e.forEach((function(e){n=Math.min(e[a],n),r=Math.max(e[a],r)})),[n,r]}),[t,a]),p=Object(o.a)(d,2),f=p[0],g=p[1],b=function(e,t){i(t?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[e,t[1]]}:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[t[0],e]})};return r.a.createElement(m.a,{className:"filter"},r.a.createElement(m.a.Row,null,r.a.createElement(S.a,{className:"pr-md-0",sm:12,md:6,lg:12},r.a.createElement(m.a.Control,{as:"input",value:n[0]||"",type:"number",onChange:function(e){var t=c.isInteger?parseInt(e.target.value,10)||0:parseFloat(e.target.value||0);b(t,!0)},placeholder:"Min (".concat(f,")"),size:"sm",min:s,max:l,step:c})),r.a.createElement(S.a,{className:"pr-md-0",sm:12,md:6,lg:12},r.a.createElement(m.a.Control,{value:n[1]||"",type:"number",onChange:function(e){var t=c.isInteger?parseInt(e.target.value,10)||0:parseFloat(e.target.value||0);b(t,!1)},placeholder:"Max (".concat(g,")"),size:"sm",min:s,max:l,step:c}))))};var V=function(e){e.title;var t=e.groupId,a=e.buttonText,n=e.component,s=e.variant,l=void 0===s?"light":s,c=e.isOpen,i=void 0!==c&&c,u=e.size,m=void 0===u?"sm":u,d=r.a.useState(i),f=Object(o.a)(d,2),b=f[0],h=f[1];return r.a.createElement(S.a,null,r.a.createElement(p.a,{onClick:function(){h(!b)},className:"show-group mb-3 mt-3","aria-controls":t,"aria-expanded":b,variant:l,size:m},b?r.a.createElement(I.a,null):r.a.createElement(I.b,null),"".concat(a)),r.a.createElement(g.a,{in:b},r.a.createElement("div",null,n)))},q=(a(376),"Sets the min and max number of misses in the virus sequence to be consider a miss"),J="Sets the min and max number of misses in the 3' end (last 5 nucleotides) of the virus sequence to be considered a miss",U="Sets the min and max percentage of match for a virus sequence to be considered a miss",W="Select the primers to display",K="Select which part of the primer to display",Y="Selects the countries to display. Total will be over selected countries then. To change, check extra settings",Z="Show the difference from the current bar and the previous bar if enable (The last bar will be compared against another bar off charts)",$="Sets the number of days between comparison",Q="Sets the number of bars to be displayed",X="Sets whether selected country will be used as total or all submission within said time frame will be used as total",ee="Divides daily mutation count by total number of submissions thus far",te="Sets the number of days to be used when aggregating the number of submissions and mutations",ae="Selects the dates of interest.",ne=function(e){var t=e.id,a=e.className,n=e.checked,s=e.onChange,l=e.ariaControls,o=void 0===l?"":l,c=e.ariaExpanded,i=void 0===c?"":c,u=e.disabled,m=void 0!==u&&u;return r.a.createElement("label",{id:t,className:"switch ".concat(a),"aria-controls":o,"aria-expanded":i},r.a.createElement("input",{type:"checkbox",checked:n,onChange:s,disabled:m}),r.a.createElement("span",{className:"slider round"}))},re=function(e){var t=e.baseData,a=e.miss,n=e.setMiss,s=e.miss3,l=e.setMiss3,o=e.match,c=e.setMatch;return r.a.createElement(d.a,null,r.a.createElement(S.a,{className:"mb-3 pr-lg-0 ",xs:12,lg:4},r.a.createElement(A.a,{size:"sm",className:""},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Total Misses",r.a.createElement(I.c,{className:"pl-1","data-tip":q}))),r.a.createElement(H,{data:t,minVal:0,maxVal:100,step:1,value:a,setFilter:n,id:"misses"}))),r.a.createElement(S.a,{className:"mb-3 pr-lg-0 pl-lg-0",xs:12,lg:4},r.a.createElement(A.a,{size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Misses in 3' End",r.a.createElement(I.c,{className:"pl-1","data-tip":J}))),r.a.createElement(H,{data:t,minVal:0,maxVal:100,step:1,value:s,setFilter:l,id:"misses3"}))),r.a.createElement(S.a,{className:"mb-3 pl-lg-0 pr-lg-0",xs:12,lg:4},r.a.createElement(A.a,{size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Homology %",r.a.createElement(I.c,{className:"pl-1","data-tip":U}))),r.a.createElement(H,{data:t,minVal:0,maxVal:100,step:.01,value:o,setFilter:c,id:"match_pct"}))))},se=function(e){var t=e.isBar,a=e.setIsBar,n=e.daysBetweenComparison,s=e.setDaysBetweenComparison,l=e.numberOfBars,o=e.setNumberOfBars,c=e.showAbsDiff,i=e.setShowAbsDiff;return r.a.createElement(d.a,null,r.a.createElement(S.a,{sm:12,lg:2},r.a.createElement(A.a,{className:"mb-3",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Show")),r.a.createElement(ne,{type:"checkbox",checked:t,onChange:function(){return a(!t)},"aria-controls":"use-bars","aria-expanded":t}))),r.a.createElement(S.a,{sm:12,lg:3},r.a.createElement(A.a,{className:"mb-3",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Absolute Diff",r.a.createElement(I.c,{className:"pl-1","data-tip":Z}))),r.a.createElement(ne,{type:"checkbox",checked:c,onChange:function(){return i(!c)},disabled:!t}))),r.a.createElement(S.a,{sm:12,lg:4},r.a.createElement(A.a,{className:"mb-3",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Days between Comparison",r.a.createElement(I.c,{className:"pl-1","data-tip":$}))),r.a.createElement(m.a.Control,{value:n.toString(),disabled:!t,as:"input",type:"number",min:1,max:200,step:1,onChange:function(e){var t=e.target.value;s(parseInt(t,10)||0)}}))),r.a.createElement(S.a,{sm:12,lg:3},r.a.createElement(A.a,{className:"mb-3",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Number of bars",r.a.createElement(I.c,{className:"pl-1","data-tip":Q}))),r.a.createElement(m.a.Control,{value:l.toString(),disabled:!t,as:"input",type:"number",min:1,max:20,step:1,onChange:function(e){var t=e.target.value;o(parseInt(t,10)||0)}}))))},le=function(e){var t=e.countryAsTotal,a=e.setCountryAsTotal;return r.a.createElement(A.a,{className:"mb-3",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,{htmlFor:"country"},"Selected Countries as Total",r.a.createElement(I.c,{className:"pl-1","data-tip":X}))),r.a.createElement(ne,{id:"country",className:"use-country",checked:t,onChange:function(e){a(e.target.checked)}}))},oe=function(e){var t=e.isBar,a=e.setIsBar,n=e.daysBetweenComparison,s=e.setDaysBetweenComparison,l=e.numberOfBars,o=e.setNumberOfBars,c=e.showAbsDiff,i=e.setShowAbsDiff,u=e.countryAsTotal,p=e.setCountryAsTotal,f=e.setTimeFrameBrush,g=e.timeFrameBrush,b=e.dateRange,h=e.lookBack,v=e.setLookBack,E=e.useCum,y=e.setUseCum,O=e.variant;return r.a.createElement(S.a,null,r.a.createElement(d.a,null,r.a.createElement(S.a,{xs:12,lg:5,className:"pr-lg-0"},r.a.createElement(A.a,{className:"mb-3 ",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Date Range",r.a.createElement(I.c,{className:"pl-1","data-tip":ae}))),r.a.createElement(P.a,{maxDate:new Date(b[b.length-1]),minDate:new Date(b[0]),calendarIcon:r.a.createElement(I.d,null),onChange:function(e){console.log("e :>> ",e),f((e||[]).map((function(e){return new Date(e)}))||[])},value:0===g.length?null:g}))),r.a.createElement(S.a,{xs:12,lg:3,className:"pr-lg-0 pl-lg-0"},r.a.createElement(A.a,{className:"mb-3",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,{htmlFor:"cumulative"},"Cumulative",r.a.createElement(I.c,{className:"pl-1","data-tip":ee}))),r.a.createElement(ne,{id:"cumulative",className:"use-cumulative",checked:E,onChange:function(e){y(e.target.checked)}}))),r.a.createElement(S.a,{xs:12,lg:4,className:"pl-lg-0"},r.a.createElement(A.a,{className:"mb-3 ",size:"sm"},r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Look Back",r.a.createElement(I.c,{className:"pl-1","data-tip":te}))),r.a.createElement(m.a.Control,{value:h.toString(),disabled:E,as:"input",type:"number",min:0,max:200,step:1,onChange:function(e){var t=e.target.value;v(parseInt(t,10)||0)}})))),r.a.createElement(V,{variant:O,buttonText:"Bar Graph Setting",groupId:"bar-graph-setting",component:r.a.createElement(se,{isBar:t,setIsBar:a,daysBetweenComparison:n,setDaysBetweenComparison:s,numberOfBars:l,setNumberOfBars:o,showAbsDiff:c,setShowAbsDiff:i})}),r.a.createElement(V,{variant:O,buttonText:"Line Graph Settings",groupId:"line-graph-settings",component:r.a.createElement(le,{countryAsTotal:u,setCountryAsTotal:p})}))},ce=function(e){var t=e.baseData,a=e.dateRange,n=e.timeFrameBrush,s=e.setTimeFrameBrush,l=e.lookBack,o=e.setLookBack,c=e.useCum,i=e.setUseCum,u=e.miss,m=e.setMiss,p=e.miss3,f=e.setMiss3,g=e.match,b=e.setMatch,h=e.countryAsTotal,v=e.setCountryAsTotal,E=e.isBar,y=e.setIsBar,O=e.daysBetweenComparison,x=e.setDaysBetweenComparison,w=e.numberOfBars,S=e.setNumberOfBars,k=e.showAbsDiff,C=e.setShowAbsDiff;return r.a.createElement(V,{variant:"light",buttonText:"More Settings",groupId:"Advance-settings",component:r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,null,r.a.createElement(V,{variant:"light",buttonText:"Adjust Miss Definition",groupId:"miss-definitions",component:r.a.createElement(re,{baseData:t,miss:u,setMiss:m,miss3:p,setMiss3:f,match:g,setMatch:b})})),r.a.createElement(d.a,null,r.a.createElement(V,{variant:"light",buttonText:"Graph and Map Settings",groupId:"graph-map-setting",component:r.a.createElement(oe,{variant:"light",setTimeFrameBrush:s,timeFrameBrush:n,dateRange:a,lookBack:l,setLookBack:o,useCum:c,setUseCum:i,isBar:E,setIsBar:y,daysBetweenComparison:O,setDaysBetweenComparison:x,numberOfBars:w,setNumberOfBars:S,showAbsDiff:k,setShowAbsDiff:C,countryAsTotal:h,setCountryAsTotal:v})})))})};function ie(e){var t,a=e.baseData,n=e.setIsProcessing,s=e.isProcessing,l=e.setCountries,o=e.primers,c=e.setPrimers,m=e.setPType,p=Object(i.f)();function f(e){return function(t){n(!0);var a=t||[];if(0===a.length)e(a);else{var r=a.map((function(e){return e.value===e.label?e.value:e}));e(r)}}}return r.a.createElement(V,{isOpen:!0,variant:"light",buttonText:"Basic Filters",groupId:"basic-settings",component:r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"mb-3"},r.a.createElement(S.a,{xs:12,lg:7,className:"mb-3"},r.a.createElement(d.a,null,r.a.createElement(S.a,{sm:12,lg:3,className:"mr-0 pr-lg-0"},r.a.createElement(A.a.Text,null,"Primers",r.a.createElement(I.c,{className:"pl-1","data-tip":W}))),r.a.createElement(S.a,{sm:12,lg:9,className:"pl-lg-0"},r.a.createElement(R,{value:o,onChange:(t=c,function(e){n(!0);var a=e||[];if(0===a.length)t(a),p.push("/results/Overview");else{var r=a.map((function(e){return e.value}));t(r),p.push("/results/".concat(r.join("&")))}}),options:r.a.useMemo((function(){return Object.keys(a).map((function(e){return{label:e,value:e}}))}),[a]),placeholder:"Select Primers to Display",isLoading:s})))),r.a.createElement(S.a,{xs:12,lg:5,className:"mb-3"},r.a.createElement(d.a,null,r.a.createElement(S.a,{sm:12,lg:5,className:"mr-0 pr-lg-0"},r.a.createElement(A.a.Text,null,"Primer Type",r.a.createElement(I.c,{className:"pl-1","data-tip":K}))),r.a.createElement(S.a,{sm:12,lg:7,className:"pl-lg-0"},r.a.createElement(R,{onChange:f(m),options:r.a.useMemo((function(){return[{label:"fwd",value:"fwd"},{label:"rev",value:"rev"},{label:"prb",value:"prb"}]}),[]),placeholder:"Specify Type",isLoading:s}))))),r.a.createElement(d.a,{className:"mb-3"},r.a.createElement(S.a,{sm:12,lg:2,className:"mr-0 pr-lg-0"},r.a.createElement(A.a.Text,null,"Counties",r.a.createElement(I.c,{className:"pl-1","data-tip":Y}))),r.a.createElement(S.a,{sm:12,lg:10,className:"pl-lg-0"},r.a.createElement(R,{className:"country-picker",onChange:f(l),options:r.a.useMemo((function(){var e=new Set;return Object.values(a).reduce((function(t,a){var n=a.reduce((function(t,a){return e.has(a.country_name)||(e.add(a.country_name),t.push({label:a.country_name,value:a.ISO_A3})),t}),[]);return t.push.apply(t,Object(u.a)(n)),t}),[])}),[a]),placeholder:"Filter Countries",isLoading:s}))))})}var ue=function(e){var t=e.baseData,a=e.dateRange,n=e.timeFrameBrush,s=e.setTimeFrameBrush,l=e.lookBack,o=e.setLookBack,c=e.useCum,i=e.setUseCum,u=e.miss,m=e.setMiss,p=e.miss3,f=e.setMiss3,g=e.match,b=e.setMatch,h=e.countryAsTotal,v=e.setCountryAsTotal,E=e.setCountries,y=e.primers,O=e.setPrimers,x=e.setPType,w=e.isProcessing,S=e.setIsProcessing,k=e.isBar,C=e.setIsBar,T=e.daysBetweenComparison,D=e.setDaysBetweenComparison,j=e.numberOfBars,B=e.setNumberOfBars,N=e.showAbsDiff,M=e.setShowAbsDiff;return r.a.createElement("div",null,r.a.createElement(d.a,null,r.a.createElement(ie,{baseData:t,isProcessing:w,setIsProcessing:S,setCountries:E,primers:y,setPrimers:O,setPType:x})),r.a.createElement(d.a,null,r.a.createElement(ce,{baseData:t,dateRange:a,timeFrameBrush:n,setTimeFrameBrush:s,lookBack:l,setLookBack:o,useCum:c,setUseCum:i,miss:u,setMiss:m,miss3:p,setMiss3:f,match:g,setMatch:b,countryAsTotal:h,setCountryAsTotal:v,setPType:x,isBar:k,setIsBar:C,daysBetweenComparison:T,setDaysBetweenComparison:D,numberOfBars:j,setNumberOfBars:B,showAbsDiff:N,setShowAbsDiff:M})),r.a.createElement(F.a,{html:!0}))},me=a(65),de=a(320),pe=a(168),fe=a(163);a(381);function ge(e){var t=e.preGlobalFilteredRows,a=e.globalFilter,n=e.setGlobalFilter,s=e.isHelpOn,l=void 0===s||s,c=t.length,i=r.a.useState(a),u=Object(o.a)(i,2),d=u[0],p=u[1],f=Object(me.useAsyncDebounce)((function(e){n(e||void 0)}),200);return r.a.createElement("div",{className:"general-search"},r.a.createElement(m.a.Row,null,r.a.createElement(m.a.Label,{column:!0,sm:12,lg:2},"General Search"),r.a.createElement(S.a,{sm:12,lg:10},r.a.createElement(m.a.Control,{type:"text",value:d||"",onChange:function(e){p(e.target.value),f(e.target.value)},placeholder:"Search the ".concat(c," entries")}))),l?r.a.createElement(m.a.Row,null,r.a.createElement(m.a.Label,{column:!0,sm:0,lg:2}),r.a.createElement(S.a,{sm:12,lg:10},r.a.createElement(m.a.Text,{className:"text-muted"},"This does not affect plot data. If you want to set filters, set the options above."))):null)}function be(e){var t=e.title,a=e.data,n=e.columns,s=e.isCombined,l=n.map((function(e){return{label:e.Header,key:e.accessor}}));s||l.push.apply(l,[{label:"ISO A3",key:"ISO_A3"},{label:"Virus Match Index (Start, End)",key:"virus_match_idx"},{label:"Primer Match Index (Start, End)",key:"query_match_idx"}]);var o=r.a.useMemo((function(){return{text:function(e,t,a){return e.filter((function(e){var n=e.values[t];return void 0===n||String(n).toLowerCase().startsWith(String(a).toLowerCase())}))}}}),[]),c=r.a.useMemo((function(){return{minWidth:80,width:160,maxWidth:600}}),[]),i=Object(me.useTable)({columns:n,data:a,initialState:{pageIndex:0},defaultColumn:c,filterTypes:o},me.useGlobalFilter,me.useSortBy,me.usePagination,me.useFlexLayout,me.useResizeColumns),u=i.getTableProps,f=i.getTableBodyProps,g=i.headerGroups,b=i.prepareRow,h=i.page,v=i.canPreviousPage,E=i.canNextPage,y=i.pageOptions,O=i.pageCount,x=i.gotoPage,w=i.nextPage,k=i.previousPage,C=i.setPageSize,T=i.state,D=T.pageIndex,j=T.pageSize,B=i.state,N=i.preGlobalFilteredRows,M=i.setGlobalFilter;return r.a.createElement("div",null,r.a.createElement("h2",{className:"table-title"},t),r.a.createElement(ge,{preGlobalFilteredRows:N,globalFilter:B.globalFilter,setGlobalFilter:M}),r.a.createElement(de.a,Object.assign({},u(),{variant:"light",responsive:!0,striped:!0,bordered:!0,hover:!0}),r.a.createElement("thead",{className:"thead"},g.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",Object.assign({},e.getHeaderProps(),{className:"table-header"}),e.render("Header"),r.a.createElement("span",e.getSortByToggleProps(),e.isSorted?e.isSortedDesc?r.a.createElement(pe.b,{className:"pl-1"}):r.a.createElement(pe.c,{className:"pl-1"}):r.a.createElement(pe.a,{className:"pl-1"})),e.canResize&&r.a.createElement("div",Object.assign({},e.getResizerProps(),{className:"resizer ".concat(e.isResizing?"isResizing":"")})))})))}))),r.a.createElement("tbody",Object.assign({},f(),{className:"tbody"}),h.map((function(e){return b(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){if("match_diag"===e.column.id){var t=e.value.split(" ").map((function(e){return e.split("")}));return r.a.createElement("td",Object.assign({},e.getCellProps(),{className:"table-cell match-diag"}),t.map((function(e,t){return r.a.createElement("div",{key:t},e.map((function(e,t){return r.a.createElement("span",{key:t,className:e},e)})))})))}return r.a.createElement("td",Object.assign({},e.getCellProps(),{className:"table-cell ".concat("country_name"===e.column.id||"virus_name"===e.column.id?"text-align-start":"")}),e.render("Cell"))})))})),E?null:r.a.createElement("tr",{className:"end-of-data"},r.a.createElement("td",null,"---------- All Data Displayed ----------")))),r.a.createElement(d.a,{className:"pagination"},r.a.createElement(S.a,{className:"page-controls",sm:12,md:4},r.a.createElement(p.a,{variant:"light",onClick:function(){return x(0)},disabled:!v},"<<"),r.a.createElement(p.a,{variant:"light",onClick:function(){return k()},disabled:!v},"<"),r.a.createElement(p.a,{variant:"light",onClick:function(){return w()},disabled:!E},">"),r.a.createElement(p.a,{variant:"light",onClick:function(){return x(O-1)},disabled:!E},">>"),r.a.createElement("p",null," ","Page ",r.a.createElement("strong",null,D+1," ")," of"," ",r.a.createElement("strong",null,y.length))),r.a.createElement(S.a,{className:"manual-page-selection",sm:12,md:4},r.a.createElement(A.a,null,r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,{id:"page-info"},"Go to page:")),r.a.createElement(m.a.Control,{type:"number",defaultValue:D+1,onChange:function(e){var t=e.target.value?Number(e.target.value)-1:0;x(t)},"aria-label":"Go To Page","aria-describedby":"page-info"}))),r.a.createElement(S.a,{className:"results-per-page",sm:12,md:4},r.a.createElement(m.a.Control,{value:j,onChange:function(e){C(Number(e.target.value))},as:"select"},[10,20,30,40,50].map((function(e){return r.a.createElement("option",{key:e,value:e},"Show ",e)}))))),r.a.createElement(d.a,null,r.a.createElement(fe.CSVLink,{data:a,headers:l,filename:s?"combined_miss.csv":"sensitivity_miss.csv",className:"btn btn-dark",target:"_blank"},"Download Table")))}var he=function(e){var t=e.title,a=e.data,n=e.columns,s=e.isCombined,l=e.isCollapsable,c=r.a.useState(!0),i=Object(o.a)(c,2),u=i[0],m=i[1];return l?r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{onClick:function(){m(!u)},className:"show-table mb-3 mt-3","aria-controls":"collapse-table","aria-expanded":u,variant:"light"},u?r.a.createElement(I.a,null):r.a.createElement(I.b,null),u?"Close Table":"Show Table"),r.a.createElement(g.a,{in:u},r.a.createElement("div",null,r.a.createElement(be,{id:"collapse-table",title:t,data:a,columns:n,isCombined:s})))):r.a.createElement("div",null,r.a.createElement(be,{id:"collapse-table",title:t,data:a,columns:n,isCombined:s}))},ve=a(114),Ee=a(164),ye=a.n(Ee),Oe=function(e){var t=e.title,a=e.title2,n=e.data,s=e.primers,l=e.dates,o=e.setTimeFrameBrush,c=e.timeFrameBrush,i=e.showModal,m=e.setModalInfo,d=e.subtitle,p=void 0===d?"":d,f=e.subtitle2,g=void 0===f?"":f;function b(e,t,a,n){for(var r=[],s=0;s<e.length;s++)r.push({name:"".concat(e[s]),type:"line",hoverAnimation:!1,xAxisIndex:a,yAxisIndex:n,encode:{x:"date",y:t},datasetIndex:s});return r}function h(e,t){if(void 0!==e){var a=t.findIndex((function(t){return e.toISOString().slice(0,10)===t}));return-1===a?void 0:a}}var E=100*(h(c[0],l)||0)/l.length,y=100*(h(c[1],l)+1||l.length)/l.length,O=b(s,"mutation_pct",0,0),x=b(s,"mutation3_pct",1,1),w=function(e){var t,a=[],n=Object(v.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.push({dimensions:["countries_considered","date","mutation3_abs","mutation3_pct","mutation_abs","mutation_pct","name","submission_count"],source:r})}}catch(s){n.e(s)}finally{n.f()}return a}(n),S={title:[{text:t,subtext:p,left:"center"},{text:a,subtext:g,left:"center",top:"center"}],tooltip:{trigger:"axis",axisPointer:{type:"cross",animation:!1},backgroundColor:"rgba(50,50,50, 0.9)",formatter:function(e){for(var t=e[0].data,a=t.date,n=-1===t.lookBack?l[0]:function(e,t,a){var n=new Date(e[0]),r=new Date(t);return r.setDate(r.getDate()-a),r<n&&(r=n),r.toISOString().slice(0,10)}(l,a,t.lookBack),r=t.submission_count,o=0===t.countries_considered.length?"all available Countries":"".concat(t.countries_considered.length," countries"),c="<div>Details from ".concat(n," to ").concat(a,"<br/>Total Submissions: ").concat(r," from ").concat(o,"</div><br/>"),i=0;i<s.length;i++)c+="<div>".concat(e[i].data.name,"\n            <br/>\n            <strong>Abs Mutation:</strong> ").concat(e[i].data.mutation_abs,"<br/>\n            <strong>Abs Mutation in 3' end:</strong> ").concat(e[i].data.mutation3_abs,"<br/>\n            <strong>Mutation %:</strong> ").concat(e[i].data.mutation_pct,"<br/>\n            <strong>Mutation % in 3' end:</strong> ").concat(e[i].data.mutation3_pct,"</div><br/>");return c},position:function(e,t,a,n,r){var s={};return s[["top","bottom"][+(e[1]<r.viewSize[1]/2)]]=10,s[["left","right"][+(e[0]<r.viewSize[0]/2)]]=30,s}},legend:{data:s,orient:"vertical",type:"scroll",top:"5%",right:0},axisPointer:{link:{xAxisIndex:"all"}},dataZoom:[{type:"slider",show:!0,realtime:!0,start:E,end:y,xAxisIndex:[0,1],top:"95%"},{type:"inside",realtime:!0,start:E,end:y,xAxisIndex:[0,1]}],grid:[{bottom:"60%",right:"15%"},{top:"57%",right:"15%"}],xAxis:[{name:"date",nameLocation:"middle",nameTextStyle:{align:"center",verticalAlign:"top",padding:[6,0,0,0]},gridIndex:0,type:"category"},{name:"date",nameLocation:"middle",nameTextStyle:{align:"center",verticalAlign:"top",padding:[6,0,0,0]},gridIndex:1,type:"category"}],yAxis:[{name:"Total Percentage (%)",gridIndex:0,nameLocation:"middle",nameGap:25},{name:"Total Percentage (%)",gridIndex:1,nameLocation:"middle",nameGap:25}],dataset:w,series:[].concat(Object(u.a)(O),Object(u.a)(x))};var k={click:function(e){console.log(e),m((function(t){return Object(ve.a)(Object(ve.a)({},t),{},{date:e.data.date,lookBack:e.data.lookBack,primer:e.data.name,country:null})})),i()},legendselectchanged:function(e){e.selected},dataZoom:function(e,t,a){var n;return function(){var r=this,s=arguments,l=function(){n=null,a||e.apply(r,s)},o=a&&!n;clearTimeout(n),n=setTimeout(l,t),o&&e.apply(r,s)}}((function(e){var t=e;void 0!==e.batch&&(t=e.batch[0]);var a=Math.floor(l.length*t.start/100),n=Math.floor(l.length*t.end/100),r=l[a]||l[0],s=l[n]||l[l.length-1],c=new Date(r),i=new Date(s);c.setDate(c.getDate()),i.setDate(i.getDate()),o([c,i])}),800)};return r.a.createElement(ye.a,{option:S,style:{height:"475px",width:"100%"},onEvents:k,notMerge:!0})},xe=function(e){var t=e.title,a=e.title2,n=e.data,s=e.showAbsDiff,l=e.subtitle,o=void 0===l?"":l,c=e.subtitle2,i=void 0===c?"":c;function m(e,t,a){return{show:!0,position:"insideTop",distance:10,align:"center",verticalAlign:"top",rotate:0,formatter:function(n){if(!s)return"".concat(n.data[a],"%");var r=n.data.name,l=(e[t].filter((function(e){return e.name===r}))[0][a]-e[t-1].filter((function(e){return e.name===r}))[0][a]).toFixed(2);return"".concat(l>0?"{p|+":l<0?"{n|":"{zero|").concat(l,"%}")},fontSize:9,backgroundColor:"#232323",textBorderColor:"transparent",padding:[4,5,2,5],rich:{p:{color:"#88ff88",fontSize:9},n:{color:"#ff8677",fontSize:9},zero:{color:"#eef",fontSize:9}}}}function d(e,t,a,n){for(var r=[],s=1;s<e.length;s++)r.push({name:(e[s][0]||{}).date,type:"bar",barMaxWidth:40,xAxisIndex:a,yAxisIndex:n,label:m(e,s,t),encode:{x:"name",y:t},datasetIndex:s});return r}var p=function(e){var t,a=[],n=Object(v.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.push({dimensions:["countries_considered","date","mutation3_abs","mutation3_pct","mutation_abs","mutation_pct","name","submission_count"],source:r})}}catch(s){n.e(s)}finally{n.f()}return a}(n),f=d(n,"mutation_pct",0,0),g=d(n,"mutation3_pct",1,1),b={title:[{text:t,subtext:o,left:"center"},{text:a,subtext:i,left:"center",top:"52%"}],tooltip:{trigger:"axis",formatter:function(e){console.log("params :>> ",e)},axisPointer:{type:"shadow",animation:!1},position:function(e,t,a,n,r){var s={top:10};return s[["left","right"][+(e[0]<r.viewSize[0]/2)]]=30,s}},axisPointer:{link:{xAxisIndex:"all"}},grid:[{top:"8%",bottom:"65%"},{top:"57%",bottom:"20%"}],xAxis:[{name:"primers",gridIndex:0,type:"category",axisLabel:{rotate:45,margin:15}},{name:"primers",gridIndex:1,type:"category",axisLabel:{rotate:45,margin:15}}],yAxis:[{name:"Total Percentage (%)",gridIndex:0,nameLocation:"middle",nameGap:50},{name:"Total Percentage (%)",gridIndex:1,nameLocation:"middle",nameGap:50}],dataset:p,series:[].concat(Object(u.a)(f),Object(u.a)(g))},h={click:function(e){console.log(e)}};return r.a.createElement(ye.a,{option:b,style:{height:"600px",width:"100%"},notMerge:!0,onEvents:h})},we=a(702),Se=a(32),ke=a(134),Ce=Object(we.a)().domain([0,1]).range(["#ffedea","#ff5233"]),Te=r.a.memo((function(e){var t=e.title,a=e.setTooltipContent,n=e.data,s=e.lookBack,l=e.db,c=e.timeFrameBrush,i=(e.setTimeFrameBrush,e.showModal),m=e.setModalInfo,d=e.subtitle,p=void 0===d?"":d,g=r.a.useState([]),b=Object(o.a)(g,2),h=b[0],E=b[1];function y(e){return new Date(e).toISOString().slice(0,10)}var O=function(e,t){if(0===e.length)return[Object.keys(t)[0],Object.keys(t)[Object.keys(t).length-1]];var a=y(e[0]),n=y(e[1]);return n>Object.keys(t)[Object.keys(t).length-1]&&(n=Object.keys(t)[Object.keys(t).length-1]),a<Object.keys(t)[0]&&(a=Object.keys(t)[0]),[a,n]}(c,l),x=Object(o.a)(O,2),w=x[0],S=x[1],k=function(e,t,a){var n=e;if(t>=0){var r=new Date(a),s=new Date(a);s.setDate(s.getDate()-t),n=e.filter((function(e){var t=new Date(e.date);return t.getTime()<=r.getTime()&&t.getTime()>=s.getTime()}))}return n.reduce((function(e,t){return e.has(t.ISO_A3)?e.set(t.ISO_A3,e.get(t.ISO_A3)+1):e.set(t.ISO_A3,1),e}),new Map)}(n,s,S),C=Array.from(k.keys()).reduce((function(e,t){return e.set(t,(k.get(t)/(l[S][t]||100)*100).toFixed(2)),e}),new Map);console.log("countryMisses :>> ",k),console.log("startDate, endDate :>> ",w,S),console.log("countryMissesPct :>> ",C);var T=Math.max.apply(Math,Object(u.a)(Array.from(C.values())));return console.log("maxPctMiss :>> ",T),r.a.createElement(f.a,null,r.a.createElement("h2",{className:"map-title"},t),r.a.createElement("h3",{className:"map-title map-subtitle"},p),r.a.createElement(ke.ComposableMap,{"data-tip":"",projectionConfig:{scale:200}},r.a.createElement(ke.ZoomableGroup,null,r.a.createElement(ke.Geographies,{geography:"https://raw.githubusercontent.com/zcreativelabs/react-simple-maps/master/topojson-maps/world-110m.json"},(function(e){return e.geographies.map((function(e){var t=k.get(e.properties.ISO_A3)||0,o=C.get(e.properties.ISO_A3)||0;return r.a.createElement(ke.Geography,{key:e.rsmKey,geography:e,onMouseEnter:function(){var n=e.properties.NAME;a("".concat(n,": <br/> \n                          ").concat(l[S][e.properties.ISO_A3]||0," submissions <br/>\n                          ").concat(t," Absolute Misses.<br/> \n                          ").concat(o,"% Miss <br/>\n                          "))},onMouseLeave:function(){a("")},onClick:function(){!function(e,t,a){Object(Se.b)(n.reduce((function(t,a){return a.ISO_A3===e?(t.push(new Date(a.date)),t):t}),[])),i(),m((function(n){return Object(ve.a)(Object(ve.a)({},n),{},{primer:null,country:e,lookBack:a,date:t})}))}(e.properties.ISO_A3,S,s)},style:{default:{fill:0!==parseFloat(o)?Ce(o/T):"#949494",outline:"none"},hover:{fill:"#afca9d",cursor:t?"pointer":"auto",outline:"none"}}})}))})))),r.a.createElement(fe.CSVLink,{data:h,headers:[{label:"Country",key:"country"},{label:"ISO A3",key:"ISO_A3"},{label:"Missed %",key:"missed_pct"},{label:"Absolute Misses",key:"abs_miss"},{label:"Submitted Virus",key:"country_total"},{label:"Start Date",key:"startDate"},{label:"End Date",key:"endDate"}],filename:"geo_misses.csv",className:"btn btn-dark",target:"_blank",onClick:function(e,t,a,n,r){return function(){var s,l=[],c=Object(v.a)(e);try{var i=function(){var e=Object(o.a)(s.value,2),c=e[0],i=e[1];l.push({country:r.find((function(e){return e.ISO_A3===c})).country_name,ISO_A3:c,country_total:i/(t.get(c)/100),missed_pct:t.get(c),abs_miss:i,startDate:a,endDate:n})};for(c.s();!(s=c.n()).done;)i()}catch(u){c.e(u)}finally{c.f()}console.log("fired",l),E(l)}}(k,C,w,S,n)},"Download Map Data"))})),De=(a(686),function(e){var t=e.title,a=e.data,n=e.lookBack,s=e.db,l=e.timeFrameBrush,c=e.setTimeFrameBrush,i=e.showModal,u=e.setModalInfo,m=e.subtitle,d=void 0===m?"":m,p=r.a.useState(""),f=Object(o.a)(p,2),g=f[0],b=f[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Te,{title:t,subtitle:d,setTooltipContent:b,data:a,lookBack:n,db:s,timeFrameBrush:l,setTimeFrameBrush:c,showModal:i,setModalInfo:u}),r.a.createElement(F.a,{html:!0},g))});Date.prototype.sameDay=function(e){return this.getFullYear()===e.getFullYear()&&this.getDate()===e.getDate()&&this.getMonth()===e.getMonth()};var je=function(){var e=Object(i.f)();return r.a.createElement(f.a,null,r.a.createElement("p",{className:"no-data"},"Please make sure that you've uploaded some data first!"),r.a.createElement(p.a,{onClick:function(){return e.push("/")}},"Upload Data"))},Be=function(e){var t=e.results,a=r.a.useRef(JSON.parse(t));console.log("result",a);var n=r.a.useRef(a.current[0]||{}),s=r.a.useRef(function(e){var t=[];if(0!==Object.keys(e).length)for(var a=Object.keys(e),n=0,r=a;n<r.length;n++){var s=r[n];t.push.apply(t,Object(u.a)(e[s].map(Ae(s))))}return t}(n.current)),l=r.a.useRef(Me(a.current,1)),c=r.a.useRef(Me(a.current,0)),m=r.a.useRef(Object.keys(c.current)||[]),b=r.a.useRef(function(e,t,a,n){for(var r={},s=t;s<a.length;s++)r[s]=_e(e,s,n);return r}(l.current,0,14,m.current)),h=(Object(i.g)().display.split("&"),r.a.useState([])),v=Object(o.a)(h,2),E=v[0],y=v[1],O=r.a.useState([]),x=Object(o.a)(O,2),w=x[0],k=x[1],T=r.a.useState([]),D=Object(o.a)(T,2),j=D[0],B=D[1],N=r.a.useState(r.a.useMemo((function(){return[]}),[])),M=Object(o.a)(N,2),A=M[0],F=M[1],I=r.a.useState(r.a.useMemo((function(){return[]}),[])),_=Object(o.a)(I,2),P=_[0],G=_[1],z=r.a.useState(r.a.useMemo((function(){return[]}),[])),L=Object(o.a)(z,2),R=L[0],H=L[1],V=r.a.useState([]),q=Object(o.a)(V,2),J=q[0],U=q[1],W=r.a.useState(!1),K=Object(o.a)(W,2),Y=K[0],Z=K[1],$=r.a.useState(!0),Q=Object(o.a)($,2),X=Q[0],ee=Q[1],te=r.a.useState(6),ae=Object(o.a)(te,2),ne=ae[0],re=ae[1],se=r.a.useState(!0),le=Object(o.a)(se,2),oe=le[0],ce=le[1],ie=r.a.useState(ne),me=Object(o.a)(ie,2),de=me[0],pe=me[1],fe=r.a.useState(1),ge=Object(o.a)(fe,2),be=ge[0],ve=ge[1],Ee=r.a.useState(!0),ye=Object(o.a)(Ee,2),we=ye[0],Se=ye[1],ke=r.a.useState(!1),Ce=Object(o.a)(ke,2),Te=Ce[0],Be=Ce[1],Ie=r.a.useState({date:null,lookBack:null,country:null,primer:null}),Pe=Object(o.a)(Ie,2),ze=Pe[0],Le=Pe[1],Re=function(){return Be(!1)},He=r.a.useCallback((function(){return Be(!0)}),[]),Ve=r.a.useState(!1),qe=Object(o.a)(Ve,2),Je=qe[0],Ue=qe[1];r.a.useEffect((function(){setTimeout((function(){return Ue(!1)}),500)}),[Je]),r.a.useEffect((function(){pe(0===ne?1:ne)}),[ne]);var We=r.a.useMemo((function(){return[{Header:"Primer",accessor:"primer",disableFilters:!0},{Header:"Accession ID",accessor:"accession_id",disableFilters:!0},{Header:"Virus Name",accessor:"virus_name",disableFilters:!0,width:200},{Header:"Diagram",accessor:"match_diag",disableFilters:!0,width:450},{Header:"Primer Type",accessor:"type",disableFilters:!0,width:120},{Header:"Homology %",accessor:"match_pct"},{Header:"Total Miss",accessor:"misses"},{Header:"Misses In 3' End",accessor:"misses3"},{Header:"Date Collected",accessor:"date",disableFilters:!0,width:140,show:!1},{Header:"Country",accessor:"country_name",disableFilters:!0}]}),[]),Ke=r.a.useMemo((function(){return[{Header:"Primer",accessor:"primer",disableFilters:!0},{Header:"Accession ID",accessor:"accession_id",disableFilters:!0},{Header:"Virus Name",accessor:"virus_name",disableFilters:!0,width:200},{Header:"Date Collected",accessor:"date",disableFilters:!0,width:140,show:!1},{Header:"Country",accessor:"country_name",disableFilters:!0}]}),[]),Ye=r.a.useMemo((function(){return Y?c.current:b.current[ne]||_e(l.current,ne,m.current)}),[Y,ne]),Ze=r.a.useMemo((function(){return s.current.filter(Ne({primers:R,pType:J,countries:P,miss:E,miss3:w,match:j}))}),[R,J,P,E,w,j]),$e=r.a.useMemo((function(){return Ze.filter(Ne({timeFrameBrush:A}))}),[Ze,A]),Qe=r.a.useMemo((function(){return $e.filter((function(e){var t=!0,a=!0,n=!0,r=!0;if(null!==ze.date&&(t=e.date===ze[0]),null!==ze.lookBack||-1!==ze.lookBack){var s=new Date(e.date),l=new Date(ze.date),o=new Date(l);o.setDate(o.getDate()-ze.lookBack),a=s>=o&&s<=l}return null!==ze.primer&&(n=e.primer===ze.primer),null!==ze.country&&(r=e.ISO_A3===ze.country),(t||a)&&n&&r}))}),[$e,ze]),Xe=r.a.useMemo((function(){return Ge(Ze,0===R.length?Object.keys(n.current):R,Ye,m.current,Y,ne,X,P)}),[Ze,R,Ye,Y,ne,X,P]),et=r.a.useMemo((function(){return oe?function(e,t,a,n,r){var s=[],l=a[1]||new Date(t[t.length-1]),o=new Date(l);o.setDate(o.getDate()-n*r);for(;o.getTime()<new Date(t[0]);)o.setDate(o.getDate()+n);for(var c=function(t){for(var a=[],n=0;n<e.length;n++){var r=e[n].filter((function(e){return new Date(e.date).sameDay(t)}));a.push.apply(a,Object(u.a)(r))}s.push(a)},i=o;i<=l;i.setDate(i.getDate()+n))c(i);return s}(Xe,m.current,A,de,be):{}}),[Xe,be,de,A,oe]),tt=r.a.useMemo((function(){return function(e){var t=new Set,a=e.reduce((function(e,a){if(t.has(a.primer)){var n=e[a.primer];return n.push(a),e[a.primer]=n,e}return t.add(a.primer),e[a.primer]=[a],e}),{}),n=[];if(t.size>1){var r=Object.keys(a).join(", ");return[n=(n=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"accession_id",a=e[0],n=1;n<e.length;n++)a=Fe(a,e[n],t);return a}(Object.values(a))).map(Ae(r)),[r]]}return[n,[]]}(JSON.parse(JSON.stringify(Ze)))}),[Ze]),at=Object(o.a)(tt,2),nt=at[0],rt=at[1],st=r.a.useMemo((function(){return Ge(nt,rt||[],Ye,m.current,Y,ne,X,P)}),[nt,rt,Ye,Y,ne,X,P]),lt=r.a.useMemo((function(){return nt.filter(Ne({timeFrameBrush:A}))}),[nt,A]);if(0!==a.current.length){console.log("graphOverview :>> ",Xe),console.log("barData :>> ",et),console.log("graphCombined :>> ",st);var ot=new Date(A[1]||m.current[m.current.length-1]),ct=new Date(A[1]||m.current[m.current.length-1]);return ct.setDate(ct.getDate()-ne),r.a.createElement("div",{className:"display-page"},r.a.createElement(f.a,null,r.a.createElement(ue,{baseData:n.current,dateRange:m.current,timeFrameBrush:A,setTimeFrameBrush:F,lookBack:ne,setLookBack:re,useCum:Y,setUseCum:Z,miss:E,setMiss:y,miss3:w,setMiss3:k,match:j,setMatch:B,countryAsTotal:X,setCountryAsTotal:ee,setCountries:G,setPrimers:H,setPType:U,isProcessing:Je,setIsProcessing:Ue,isBar:oe,setIsBar:ce,daysBetweenComparison:de,setDaysBetweenComparison:pe,numberOfBars:be,setNumberOfBars:ve,showAbsDiff:we,setShowAbsDiff:Se}),r.a.createElement(he,{id:"collapse-table",title:"Overview of Missed Viruses",data:$e,columns:We,isCombined:!1,isCollapsable:!0,className:"mb-5"}),r.a.createElement(d.a,{className:"mb-5"},r.a.createElement(S.a,{xs:12,lg:1===R.length?6:12},r.a.createElement(Oe,{title:"Genomes with mutation",title2:"Genomes with mutation in 3' end",data:Xe,primers:0===R.length?Object.keys(n.current):R,dates:m.current,setPrimers:H,timeFrameBrush:A,setTimeFrameBrush:F,showModal:He,setModalInfo:Le})),1===R.length?r.a.createElement(S.a,{xs:12,lg:6},r.a.createElement(De,{title:"Map of Virus Missed",subtitle:Y?"Cumulative":"From ".concat(ct.toISOString().slice(0,10)," to ").concat(ot.toISOString().slice(0,10)),data:$e,lookBack:Y?-1:ne,db:Y?c.current:Ye,timeFrameBrush:A,setTimeFrameBrush:F,showModal:He,setModalInfo:Le})):null),oe?r.a.createElement(xe,{title:"Genomes with mutation",title2:"Percent of genomes with mutation in 3' end",data:et,showAbsDiff:we,className:"mb-5"}):null,r.a.createElement(g.a,{in:0!==nt.length},r.a.createElement("div",null,r.a.createElement(d.a,{className:"mb-5"},r.a.createElement(S.a,{xs:12,lg:6},r.a.createElement(Oe,{title:"Genomes with mutation (Combined)",title2:"Genomes with mutation in 3' end (Combined)",data:st,primers:0===R.length?[Object.keys(n.current).join(", ")]:[R.join(", ")],dates:m.current,setPrimers:H,timeFrameBrush:A,setTimeFrameBrush:F,showModal:He,setModalInfo:Le})),r.a.createElement(S.a,{xs:12,lg:6},r.a.createElement(De,{title:"Map of Virus Missed (Combined)",subtitle:Y?"Cumulative":"From ".concat(ct.toISOString().slice(0,10)," to ").concat(ot.toISOString().slice(0,10)),data:lt,lookBack:Y?-1:ne,db:Y?c.current:Ye,timeFrameBrush:A,setTimeFrameBrush:F,showModal:He,setModalInfo:Le}))),r.a.createElement(he,{title:"Missed Viruses (Combined)",data:lt,columns:Ke,isCombined:!0,isCollapsable:!0,className:"mb-5"})))),r.a.createElement(C.a,{show:Te,onHide:Re,dialogClassName:"modal-90w","aria-labelledby":"missed-details-modal"},r.a.createElement(C.a.Header,{closeButton:!0,id:"missed-details-modal"},r.a.createElement(C.a.Title,null,"Missed Viruses")),r.a.createElement(C.a.Body,null,r.a.createElement(he,{id:"detail-table",title:"",data:Qe,columns:We,isCombined:!1,isCollapsable:!1,className:"mb-5"})),r.a.createElement(C.a.Footer,null,r.a.createElement(p.a,{variant:"secondary",onClick:Re},"Close"))))}return r.a.createElement(je,null)},Ne=function(e){var t=e.timeFrameBrush,a=void 0===t?[]:t,n=e.primers,r=void 0===n?[]:n,s=e.pType,l=void 0===s?[]:s,c=e.countries,i=void 0===c?[]:c,u=e.miss,m=void 0===u?[]:u,d=e.miss3,p=void 0===d?[]:d,f=e.match,g=void 0===f?[]:f;return function(e){var t=!0,n=!0,s=!0,c=!0,u=!0,d=!0,f=!0;if(0!==a.length){var b=new Date(e.date),h=Object(o.a)(a,2),v=h[0],E=h[1];t=b.getTime()>=new Date(v).getTime()&&b.getTime()<=new Date(E).getTime()}return 0!==r.length&&(n=r.includes(e.primer)),0!==l.length&&(s=l.includes(e.type)),0!==i.length&&(c=i.map((function(e){return e.label})).includes(e.country_name)),0!==m.length&&(u=e.misses>=(m[0]||0)&&e.misses<=(m[1]||100)),0!==p.length&&(d=e.misses3>=(p[0]||0)&&e.misses3<=(p[1]||100)),0!==g.length&&(f=e.match_pct>=(g[0]||0)&&e.match_pct<=(g[1]||100)),t&&n&&s&&c&&u&&d&&f}};function Me(e,t){return 0!==e.length?JSON.parse(JSON.stringify(e[1][t])):{}}function Ae(e){return function(t){return t.primer=e,t}}function Fe(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(a){var r=e.filter((s=new Set(t.map((function(e){return e[a]}))),function(e){return n===s.has(e[a])}));return r}var s,l=e.filter(function(e){return function(t){return n===e.has(t)}}(new Set(t.map((function(e){return e})))));return l}function Ie(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=0,r=Object.keys(t);n<r.length;n++){var s=r[n];e[s]=(e[s]||a)+t[s]}return e}function _e(e,t,a){var n,r={},s=Object(v.a)(a);try{for(s.s();!(n=s.n()).done;){var l=n.value,o=new Date(l),c=new Date(l);c.setDate(c.getDate()-t);for(var i={total:0},u=c;u<=o;u.setDate(u.getDate()+1)){i=Ie(i,e[u.toISOString().slice(0,10)]||{})}r[l]=i}}catch(m){s.e(m)}finally{s.f()}return r}function Pe(e,t,a){return 0===t.length?e[a].total:t.reduce((function(t,n){return t+=e[a][n.value]||0}),0)}function Ge(e,t,a,n,r,s,l){var o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],c=[];if(0===e.length)return c;var i,u=r?e.reduce((function(e,t){var a=e[t.primer]||[];return a.push(t),e[t.primer]=a,e}),{}):e.reduce((function(e,t){var a=e[t.primer]||{},n=a[t.date]||[];return n.push(t),a[t.date]=n,e[t.primer]=a,e}),{}),m=Object(v.a)(t);try{var d=function(){var e=i.value;c.push(n.map((function(t){var n=new Date(t),c=[],i=[];if(r)c=u[e].filter((function(e){return new Date(e.date).getTime()<=n.getTime()})),i=u[e].filter((function(e){return new Date(e.date).getTime()<=n.getTime()&&0!==e.misses3}));else{var m=new Date(t);m.setDate(m.getDate()-s);for(var d=m;d<=n;d.setDate(d.getDate()+1))c.push.apply(c,u[e][d.toISOString().slice(0,10)]),i.push.apply(i,u[e][d.toISOString().slice(0,10)])}c=c.reduce((function(e,t){return e.add(t.virus_name),e}),new Set).size,i=i.reduce((function(e,t){return e.add(t.virus_name),e}),new Set).size;var p=l?Pe(a,o,t):a[t].total;return{date:t,name:e,mutation_pct:(c/p*100).toFixed(3),mutation3_pct:(i/p*100).toFixed(3),mutation_abs:c,mutation3_abs:i,submission_count:p,lookBack:r?-1:s,countries_considered:o}})))};for(m.s();!(i=m.n()).done;)d()}catch(p){m.e(p)}finally{m.f()}return c}a(687),a(688);var ze=function(){var e=Object(n.useState)("[]"),t=Object(o.a)(e,2),a=t[0],s=t[1];return r.a.createElement(c.a,{basename:"/METHODS/corona/gamma/primer/build"},r.a.createElement(c.b,{to:"/",style:{textDecoration:"none"}},r.a.createElement("h1",{className:"title"},"Primer Checker")),r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/"},r.a.createElement(M,{setResults:s})),r.a.createElement(i.a,{exact:!0,path:"/results/:display"},r.a.createElement(Be,{results:a})),r.a.createElement(i.a,{path:"/results"},r.a.createElement(Be,{results:a})),r.a.createElement(i.a,{path:"/"},r.a.createElement("div",null,"404: Page not found"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ze,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[326,1,2]]]);
//# sourceMappingURL=main.84bc651b.chunk.js.map