(this.webpackJsonpprimer_checker=this.webpackJsonpprimer_checker||[]).push([[0],{199:function(e,t,a){e.exports=a(278)},204:function(e,t,a){},206:function(e,t,a){},210:function(e,t,a){},211:function(e,t,a){},212:function(e,t,a){},229:function(e,t,a){},232:function(e,t,a){},234:function(e,t,a){},267:function(e,t,a){},271:function(e,t,a){},272:function(e,t,a){},274:function(e,t,a){},275:function(e,t,a){},278:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),l=a(52),c=a.n(l),o=(a(204),a(18)),i=a(10),s=a(24),u=a(59),m=a(34),d=a(32),f=a(185),p=a(153),v=a(85),g=a(27),h=a(9),b=a(16),E=a.n(b),y=a(23),O=(a(206),function(e){return null!==/^>fwd[\s\S]{2}[ACGTacgt]+[\s\S]{1,2}>rev[\s\S]{1,2}[ACGTacgt]+[\s\S]{1,2}>prb[\s\S]{1,2}[ACGTacgt]+[\s\S]{1,2}$/.exec(e)});var w=function(e){var t=e.selectedFiles,a=e.setSelectedFiles,n=e.setErrorMessage,l=function(){var e=Object(y.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files,e.next=3,c(a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(y.a)(E.a.mark((function e(n){var r,l,c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],l=Object(h.a)(n),e.prev=2,l.s();case 4:if((c=l.n()).done){e.next=13;break}return s=c.value,e.t0=r,e.next=9,o(s);case 9:e.t1=e.sent,r=e.t0.concat.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),l.e(e.t2);case 18:return e.prev=18,l.f(),e.finish(18);case 21:a(t.concat.apply(t,Object(i.a)(r)));case 22:case"end":return e.stop()}}),e,null,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(y.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u(t);case 3:return a=e.sent,e.abrupt("return",a);case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),u=function(e){var t=new FileReader;return console.log(e),new Promise((function(a,r){t.onload=function(t){O(t.target.result)?(e.invalid=!1,e.content=t.target.result,e.id=e.name):(console.log("file loaded but invalid format"),n("File not a recognized format. Please check"),e.invalid=!0),a(e)},t.onerror=function(){t.abort(),r(new DOMException("Problem parsing input file."))},t.readAsText(e,"UTF-8")}))};return r.a.createElement(s.a.Group,{controlId:"fasta-sequence"},r.a.createElement("label",{htmlFor:"fasta-input",id:"fasta-input-label"},r.a.createElement(d.a,{className:"drop-container",onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault()},onDragLeave:function(e){e.preventDefault()},onDrop:function(e){e.preventDefault();var t=e.dataTransfer.files;c(t)}},r.a.createElement("div",{className:"drop-message"},r.a.createElement("div",{className:"upload-icon"}),"Drag & Drop files here or click to upload"),r.a.createElement("input",{className:"file-input",id:"fasta-input",type:"file",onChange:l,multiple:!0}))))},j=(a(210),a(33)),_=function(e){var t=e.setTextFieldFasta,a=Object(n.useState)(""),l=Object(o.a)(a,2),c=l[0],i=l[1],d=Object(n.useState)(""),f=Object(o.a)(d,2),p=f[0],v=f[1],g=">fwd\nGTGAAATGGTCATGTGTGGCGG\n>rev\nTATGCTAATAGTGTTTTTAACATTTG\n>prb\nCAGGTGGAACCTCATCAGGAGATGC";Object(n.useEffect)((function(){O(p)?(console.log("sequence oKAY!",p),t([{invalid:!1,content:p,id:"text_input_fasta"}])):(console.log("Nope"),t([]),i("Sequence not recognized! Please check."))}),[p,t]);return r.a.createElement(s.a.Group,{controlId:"fasta-sequence"},r.a.createElement(u.a,{className:"fasta-input-header"},r.a.createElement(j.a,null,r.a.createElement(s.a.Label,{className:"fasta-input-title"},"Fasta Sequence")),r.a.createElement(j.a,{className:"sample-fasta"},r.a.createElement(m.a,{variant:"secondary",size:"sm",onClick:function(){v(g)}},"Sample Input"))),r.a.createElement(s.a.Control,{as:"textarea",placeholder:"Input Fasta Seq here.",onChange:function(e){var t=e.target.value;v(t)},type:"text",value:p,className:"mx-sm-lg-auto","aria-describedby":"fastaSequenceHelpBlock"}),r.a.createElement(s.a.Text,{id:"fastaSequenceHelpBlock",muted:!0},"Format for the primer sequence should be as follows:",r.a.createElement("br",null),r.a.createElement("strong",null,g.split("\n").map((function(e,t){return r.a.createElement("p",{key:t},e)})))),r.a.createElement(s.a.Control.Feedback,{type:"invalid"},c))},S=(a(211),a(212),a(89)),k=function(e){var t=e.show,a=e.handleClose,n=e.content;return r.a.createElement(S.a,{show:t,onHide:a},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Fasta Primer Preview")),r.a.createElement(S.a.Body,null,function(e){for(var t=Object(i.a)(e.matchAll(/\s+/g)),a=[],n=0;n<t.length;n++)a=0===n?a.concat(e.slice(0,t[0].index)):a.concat(e.slice(t[n-1].index+1,t[n].index));return a}(n).map((function(e,t){return r.a.createElement("p",{key:t},e)}))),r.a.createElement(S.a.Footer,null,r.a.createElement(m.a,{variant:"primary",onClick:a},"Close")))},C=function(e){var t=e.file,a=e.errorMessage,l=e.setSelectedFiles,c=Object(n.useState)(""),i=Object(o.a)(c,2),s=i[0],f=i[1],p=Object(n.useState)(!1),v=Object(o.a)(p,2),g=v[0],h=v[1],b=function(e){l((function(t){return t.filter((function(t){return t.name!==e}))}))};return r.a.createElement(d.a,{className:"file-status-bar"},r.a.createElement(u.a,null,r.a.createElement("div",{className:"file-type-logo"}),r.a.createElement("div",{className:"file-type"},function(e){var t=e.substring(e.lastIndexOf(".")+1,e.length);return t.length===e.length?"Fasta":t}(t.name)),r.a.createElement(j.a,{lg:5,md:12,className:"file-info"},r.a.createElement("div",{className:"file-name ".concat(t.invalid?"file-error":""),onClick:t.invalid?function(){return b(t.name)}:function(){return function(e){f(e.content),h(!0)}(t)}},t.name),r.a.createElement("div",{className:"file-size"},"(",function(e){if(0===e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][t]}(t.size),")")),r.a.createElement(j.a,{lg:4,md:8,className:"file-error-message"},t.invalid?r.a.createElement("div",{className:"file-error-message-text"},"(",a,")"):null),r.a.createElement(j.a,{lg:2,md:2,className:"file-remove"},r.a.createElement(m.a,{onClick:function(){return b(t.name)},variant:"danger",size:"sm"},"Remove"))),r.a.createElement(k,{show:g,handleClose:function(){return h(!1)},content:s}))},F=a(150),T=a.n(F),x="https://mendel2.bii.a-star.edu.sg/METHODS/corona/gamma/cgi-bin/cgi_scripts/primerMVP.py",N=function(e){var t={data:e};return T.a.post("".concat(x),t)},D=(a(229),function(e){var t=e.setResults,a=Object(n.useState)(!1),l=Object(o.a)(a,2),c=l[0],h=l[1],b=Object(n.useState)([]),E=Object(o.a)(b,2),y=E[0],O=E[1],j=Object(n.useState)([]),S=Object(o.a)(j,2),k=S[0],F=S[1],T=Object(n.useState)([]),x=Object(o.a)(T,2),D=x[0],M=x[1],A=Object(n.useState)([]),G=Object(o.a)(A,2),I=G[0],P=G[1],B=Object(n.useState)(""),H=Object(o.a)(B,2),q=H[0],R=H[1],L=Object(n.useState)(""),V=Object(o.a)(L,2),z=V[0],Q=V[1],W=Object(n.useState)(!0),J=Object(o.a)(W,2),K=J[0],U=J[1],$=Object(n.useState)(!1),Y=Object(o.a)($,2),Z=Y[0],X=Y[1],ee=Object(g.f)(),te="open-containers";Object(n.useEffect)((function(){var e=y.reduce((function(e,t){return e.find((function(e){return e.name===t.name}))?e:e.concat(t)}),[]);F(Object(i.a)(e))}),[y]),Object(n.useEffect)((function(){var e=k.reduce((function(e,t){return t.invalid?e:e.concat(t)}),[]);M(e)}),[k]),Object(n.useEffect)((function(){if(D.length===k.length&&0!==D.length&&0===I.length||0!==I.length&&0===D.length)return console.log(D),Q(""),h(!0);0!==I.length&&0!==D.length&&(h(!1),Q("Either upload a single sequence through input or select files to upload! Not Both!")),h(!1)}),[D,k,I]);return r.a.createElement("div",null,r.a.createElement(f.a,{id:te,in:K},r.a.createElement("div",{className:"collapse-container"},r.a.createElement(d.a,null,r.a.createElement(s.a,{noValidate:!0},r.a.createElement(_,{setTextFieldFasta:P}),r.a.createElement("p",{className:"alternative-upload"},"OR"),r.a.createElement(w,{selectedFiles:y,setSelectedFiles:O,setErrorMessage:R})),r.a.createElement(d.a,{className:"file-display-container"},k.map((function(e,t){return r.a.createElement(C,{file:e,errorMessage:q,setSelectedFiles:O,key:t})})))))),r.a.createElement(d.a,null,r.a.createElement(u.a,{className:"upload-error-message"},z),c?r.a.createElement(v.a,{in:K},r.a.createElement(m.a,{id:te,"aria-controls":te,"aria-expanded":K,onClick:function(){console.log(D,I),U(!K),X(!0),setTimeout((function(){N(0===D.length?I:D).then((function(e){h(!1),O([]),P([]),R(""),Q(""),X(!1),console.log("response is",e),console.log("data from is: ",e.data),t(e.data[0]),ee.push("/results/Overview")})).catch((function(e){return console.log(e)}))}),500)},disabled:Z},Z?r.a.createElement(p.a,{as:"span",className:"loader",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):null,Z?"Loading...":"Submit")):null,Z?r.a.createElement(v.a,{in:!K},r.a.createElement(d.a,{className:"loading-container"},r.a.createElement(p.a,{id:te,as:"span",animation:"border",role:"status",variant:"dark"}))):null))}),M=(a(232),a(233),a(71)),A=a(74),G=a(117),I=(a(234),r.a.forwardRef((function(e,t){var a=e.children,l=e.style,c=e.className,i=e["aria-labelledby"],s=Object(n.useState)(""),u=Object(o.a)(s,2),m=u[0],d=u[1];return r.a.createElement("div",{ref:t,style:l,className:c,"aria-labelledby":i},r.a.createElement(G.a,{autoFocus:!0,className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return d(e.target.value)},value:m}),r.a.createElement("ul",{className:"list-unstyled"},r.a.Children.toArray(a).filter((function(e){return!m||e.props.children.toLowerCase().startsWith(m)}))))}))),P=function(e){var t=e.displayOptions,a=e.resultToDisplay,n=Object(g.f)(),l=Object(g.g)(),c=Object(g.i)(),o=function(e){var t=e.target.innerText,a=c.url.split("/")[2].split("&");if(a.includes("Overview")||"Overview"===t)n.push("/results/".concat(t));else if(a.includes(t)){var r=a;a.length>1&&(r=a.filter((function(e){return e!==t}))),n.push("/results/".concat(r.join("&")))}else n.push("".concat(l.pathname,"&").concat(t))};return r.a.createElement("div",null,r.a.createElement("p",{className:"display-tag"},"Displaying"),r.a.createElement(A.a,{className:"dropdown"},r.a.createElement(A.a.Toggle,{variant:"light",id:"dropdown-custom-components"},a.join(", ")),r.a.createElement(A.a.Menu,{as:I},r.a.createElement(A.a.Item,{as:"button",onClick:o,active:"Overview"===a[0]},"Overview"),r.a.createElement(A.a.Divider,null,"overview"),t.map((function(e,t){return"databaseCount"!==e?r.a.createElement(A.a.Item,{key:t,onClick:o,active:a.find((function(t){return t===e}))},e):null})))))},B=a(192),H=a(191),q=(a(267),a(276));var R=Object(n.memo)((function(e){var t=e.toDisplay,a=e.data,l=e.combinedOverview,c=e.timeFrameBrush,i=e.setTimeFrameBrush,u=Object(n.useState)(6),m=Object(o.a)(u,2),f=m[0],p=m[1],v=r.a.useRef(null);var g=a.filter((function(e){return"Overview"!==t[0]?t.includes(e.name):e}));return Object(n.useEffect)((function(){var e=function(e,t,a,n,r){var l,c,o=.8*n,i="smooth_mutation_pct",s="smooth_mutation3_pct",u=void 0===r||0===r.length?q.selectInterval().encodings("x"):q.selectInterval().encodings("x").init({x:r.map((function(e){return e/1}))}),m=[q.window(q.mean("total_mut_pct").as("total_smooth_mut_pct")).frame([-e,0]),q.window(q.mean("total_mut3_pct").as("total_smooth_mut3_pct")).frame([-e,0]),q.window(q.mean("mutation_pct").as(i)).frame([-e,0]),q.window(q.mean("mutation3_pct").as(s)).frame([-e,0])],d=q.x().fieldT("date").title(null),f=q.y(),p=q.color().fieldN("name").scale({scheme:"tableau20"}).legend({type:"symbol",orient:"top",columns:3}),v=(l=q.markLine().select(u)).transform.apply(l,m).encode(d,f.fieldQ(i),p).width(o).height(60).title("TimeFrame Selection"),g=(c=q.markLine({point:!0})).transform.apply(c,m).encode(d.scale({domain:u}).title("Date"),f,p,q.tooltip([{field:"name",type:"  nominal"},{field:"date",type:"temporal"},{field:i,type:"quantitative"},{field:s,type:"quantitative"},{field:"mutation_pct",type:"quantitative"},{field:"mutation3_pct",type:"quantitative"}])).width(o),h=g.data(a).encode(q.tooltip([{field:"name",type:"  nominal"},{field:"date",type:"temporal"},{field:"total_mut_pct",type:"quantitative"},{field:"total_smooth_mut_pct",type:"quantitative"},{field:"total_mut3_pct",type:"quantitative"},{field:"total_smooth_mut3_pct",type:"quantitative"}]));return 1===t.reduce((function(e,t){return e.includes(t.name)||e.push(t.name),e}),[]).length?q.data(t).vconcat(v,g.encode(f.fieldQ(i)).title("Mutation Percentage"),g.encode(f.fieldQ(s)).title("Mutation Percentage 3' end")):q.data(t).vconcat(v,q.layer(h.encode(f.fieldQ("total_smooth_mut_pct"),q.color({value:"#aaee99"})),h.encode(f.fieldQ("total_smooth_mut3_pct"),q.color({value:"#ff99aa"}))).title("Combined Mutation Percentage"),g.encode(f.fieldQ(i)).title("Mutation Percentage"),g.encode(f.fieldQ(s)).title("Mutation Percentage 3' end"))}(f,g,l,v.current.offsetWidth,c),t="";Object(H.a)("#chart",e.toJSON(),{patch:function(e){console.log(e);var a,n=e.signals,r=Object(h.a)(n);try{for(r.s();!(a=r.n()).done;){var l=a.value;l.name.startsWith("sel")&&(t=l.name)}}catch(c){r.e(c)}finally{r.f()}return e}}).then((function(e){e.view.addSignalListener(t,function(e,t,a){var n;return function(){var r=this,l=arguments,c=function(){n=null,a||e.apply(r,l)},o=a&&!n;clearTimeout(n),n=setTimeout(c,t),o&&e.apply(r,l)}}((function(e,t){var a=t.date;i(void 0===a?[]:a)}),200))})).catch(console.warn)}),[f,g,l,c,i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,null,r.a.createElement(s.a.Group,{controlId:"formBasicRange"},r.a.createElement(s.a.Label,null,"Look back period: ",f),r.a.createElement(s.a.Control,{type:"range",onChange:function(e){p(e.target.value)},min:0,max:30,step:1,value:f}))),r.a.createElement(d.a,{id:"chart",ref:v}))})),L=a(307),V=a(29),z=a(99),Q=a(130),W=(a(271),Object(L.a)().domain([0,1]).range(["#ffedea","#ff5233"])),J=Object(n.memo)((function(e){var t=e.setTooltipContent,a=e.data,n=e.db,l=e.timeFrameBrush,c=e.setTimeFrameBrush,s=r.a.useState([]),u=Object(o.a)(s,2),m=u[0],f=u[1];function p(e){var t=new Date(e);return new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]}var v=function(e){return e.reduce((function(e,t){return e.has(t.ISO_A3)?e.set(t.ISO_A3,e.get(t.ISO_A3)+1):e.set(t.ISO_A3,1),e}),new Map)}(a),g=function(e,t){return 0===e.length?[Object.keys(t)[0],Object.keys(t)[Object.keys(t).length-1]]:[p(e[0]),p(e[1])]}(l,n),b=Object(o.a)(g,2),E=b[0],y=b[1],O=Array.from(v.keys()).reduce((function(e,t){return e.set(t,(v.get(t)/(n[y][t]||100)*100).toFixed(2)),e}),new Map);console.log("countryMissesPct :>> ",O),console.log("countryMissesPct.values() :>> ",O.values());var w=Math.max.apply(Math,Object(i.a)(Array.from(O.values())));return console.log("maxPctMiss :>> ",w),r.a.createElement(d.a,null,r.a.createElement("h2",null,"Map of viruses mutations"),r.a.createElement(Q.CSVLink,{data:m,headers:[{label:"Country",key:"country"},{label:"ISO A3",key:"ISO_A3"},{label:"Missed %",key:"missed_pct"},{label:"Absolute Misses",key:"abs_miss"},{label:"Submitted Virus",key:"country_total"},{label:"Start Date",key:"startDate"},{label:"End Date",key:"endDate"}],filename:"geo_misses.csv",className:"btn btn-dark",target:"_blank",onClick:function(e,t,a,n,r){return function(){var l,c=[],i=Object(h.a)(e);try{var s=function(){var e=Object(o.a)(l.value,2),i=e[0],s=e[1];c.push({country:r.find((function(e){return e.ISO_A3===i})).country_name,ISO_A3:i,country_total:s/(t.get(i)/100),missed_pct:t.get(i),abs_miss:s,startDate:a,endDate:n})};for(i.s();!(l=i.n()).done;)s()}catch(u){i.e(u)}finally{i.f()}console.log("fired",c),f(c)}}(v,O,E,y,a)},"Download Map Data"),r.a.createElement(z.ComposableMap,{"data-tip":"",projectionConfig:{scale:200}},r.a.createElement(z.ZoomableGroup,null,r.a.createElement(z.Geographies,{geography:"https://raw.githubusercontent.com/zcreativelabs/react-simple-maps/master/topojson-maps/world-110m.json"},(function(e){return e.geographies.map((function(e){var n=v.has(e.properties.ISO_A3)?v.get(e.properties.ISO_A3):0,l=O.get(e.properties.ISO_A3)||0;return r.a.createElement(z.Geography,{key:e.rsmKey,geography:e,onMouseEnter:function(){var a=e.properties.NAME;t("".concat(a,": <br/> \n                        ").concat(n," Absolute Misses.<br/> \n                        ").concat(l,"% Miss: "))},onMouseLeave:function(){t("")},onClick:function(){!function(e,t){var a=Object(V.b)(t.reduce((function(t,a){return a.ISO_A3===e?(t.push(new Date(a.date)),t):t}),[]));if(void 0!==a[0])if(a[0]===a[1]){var n=new Date(a[1]),r=new Date(a[1]);n.setHours(n.getHours()+23),r.setHours(r.getHours()-23),c([r,n])}else c(a)}(e.properties.ISO_A3,a)},style:{default:{fill:0!==parseInt(l)?W(l/w):"#949494",outline:"none"},hover:{fill:"#afca9d",cursor:"pointer",outline:"none"}}})}))})))))})),K=(a(272),function(e){var t=e.toDisplay,a=e.overviewData,l=e.combinedOverview,c=e.mapData,i=e.dbCount,s=e.timeFrameBrush,u=e.setTimeFrameBrush,m=Object(n.useState)(""),d=Object(o.a)(m,2),f=d[0],p=d[1];return r.a.createElement("div",{className:"result-display-container"},r.a.createElement(R,{toDisplay:t,data:a,combinedOverview:l,timeFrameBrush:s,setTimeFrameBrush:u}),r.a.createElement("div",null,r.a.createElement(J,{setTooltipContent:p,data:c,db:i,toDisplay:t,timeFrameBrush:s,setTimeFrameBrush:u}),r.a.createElement(B.a,{html:!0},f)))}),U=a(73),$=a(190),Y=a(133);a(274);function Z(e){var t=e.preGlobalFilteredRows,a=e.globalFilter,n=e.setGlobalFilter,l=t.length,c=r.a.useState(a),i=Object(o.a)(c,2),u=i[0],m=i[1],d=Object(U.useAsyncDebounce)((function(e){n(e||void 0)}),200);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a.Row,null,r.a.createElement(s.a.Label,{column:!0,lg:2},"General Search"),r.a.createElement(j.a,null,r.a.createElement(s.a.Control,{type:"text",value:u||"",onChange:function(e){m(e.target.value),d(e.target.value)},placeholder:"Search the ".concat(l," entries")}))),r.a.createElement(s.a.Row,null,r.a.createElement(s.a.Label,{column:!0,lg:2}),r.a.createElement(j.a,null,r.a.createElement(s.a.Text,{className:"text-muted"},"This does not affect plot data. If you want to set filters, use the filter options under specific headers"))))}function X(e){var t=e.column,a=t.filterValue,n=void 0===a?[]:a,l=t.preFilteredRows,c=t.setFilter,i=t.id,u=r.a.useMemo((function(){var e=l.length?l[0].values[i]:0,t=l.length?l[0].values[i]:0;return l.forEach((function(a){e=Math.min(a.values[i],e),t=Math.max(a.values[i],t)})),[e,t]}),[i,l]),m=Object(o.a)(u,2),d=m[0],f=m[1];return r.a.createElement(s.a,null,r.a.createElement(s.a.Row,null,r.a.createElement(j.a,null,r.a.createElement(s.a.Control,{value:n[0]||"",type:"number",onChange:function(e){var t=e.target.value;c((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[t?parseInt(t,10):void 0,e[1]]}))},placeholder:"Min (".concat(d,")")})),r.a.createElement(j.a,null,r.a.createElement(s.a.Control,{value:n[1]||"",type:"number",onChange:function(e){var t=e.target.value;c((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[e[0],t?parseInt(t,10):void 0]}))},placeholder:"Max (".concat(f,")")}))))}function ee(e){var t=e.column,a=t.filterValue,n=(t.preFilteredRows,t.setFilter);return r.a.createElement(s.a.Control,{value:a||"",onChange:function(e){n(e.target.value||void 0)},placeholder:"Filter Country"})}function te(e){var t=e.column,a=t.filterValue,n=t.setFilter,l=t.preFilteredRows,c=t.id,o=r.a.useMemo((function(){var e=new Set;return l.forEach((function(t){e.add(t.values[c])})),Object(i.a)(e.values())}),[c,l]);return r.a.createElement("select",{value:a,onChange:function(e){n(e.target.value||void 0)}},r.a.createElement("option",{value:""},"All"),o.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))}var ae=function(e){var t=e.data,a=r.a.useMemo((function(){return[{Header:"Primer",accessor:"primer",Filter:te,filter:"includes"},{Header:"Accession ID",accessor:"accession_id",disableFilters:!0},{Header:"Virus Name",accessor:"virus_name",disableFilters:!0},{Header:"Diagram",accessor:"match_diag",disableFilters:!0},{Header:"Primer Type",accessor:"type",Filter:te,filter:"includes"},{Header:"Homology %",accessor:"match_pct"},{Header:"Total Miss",accessor:"misses"},{Header:"Misses In 3' End",accessor:"misses3"},{Header:"Date Collected",accessor:"date",disableFilters:!0},{Header:"Location",accessor:"country_name",Filter:ee,filter:"text"}]}),[]),n=a.map((function(e){return{label:e.Header,key:e.accessor}}));n.push.apply(n,[{label:"ISO A3",key:"ISO_A3"},{label:"Virus Match Index (Start, End)",key:"virus_match_idx"},{label:"Primer Match Index (Start, End)",key:"query_match_idx"}]);var l=r.a.useMemo((function(){return{text:function(e,t,a){return e.filter((function(e){var n=e.values[t];return void 0===n||String(n).toLowerCase().startsWith(String(a).toLowerCase())}))}}}),[]),c=r.a.useMemo((function(){return{Filter:X,filter:"between"}}),[]),o=Object(U.useTable)({columns:a,data:t,initialState:{pageIndex:0},defaultColumn:c,filterTypes:l},U.useFilters,U.useGlobalFilter,U.usePagination),i=o.getTableProps,f=o.getTableBodyProps,p=o.headerGroups,v=o.prepareRow,g=o.page,h=o.canPreviousPage,b=o.canNextPage,E=o.pageOptions,y=o.pageCount,O=o.gotoPage,w=o.nextPage,_=o.previousPage,S=o.setPageSize,k=o.state,C=k.pageIndex,F=k.pageSize,T=o.state,x=o.preGlobalFilteredRows,N=o.setGlobalFilter;return r.a.createElement(d.a,null,r.a.createElement("h2",{className:"table-title"},"Overview of Missed Viruses"),r.a.createElement(Z,{preGlobalFilteredRows:x,globalFilter:T.globalFilter,setGlobalFilter:N}),r.a.createElement($.a,Object.assign({},i(),{variant:"light",responsive:!0,striped:!0,bordered:!0,hover:!0}),r.a.createElement("thead",null,p.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",Object.assign({},e.getHeaderProps(),{className:"table-header"}),e.render("Header"),r.a.createElement("div",null,e.canFilter?e.render("Filter"):null))})))}))),r.a.createElement("tbody",f(),g.map((function(e){return v(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){if(console.log(e),"match_diag"===e.column.id){var t=e.value.split(" ").map((function(e,t){return e.split("")}));return r.a.createElement("td",Object.assign({},e.getCellProps(),{className:"table-cell match-diag"}),r.a.createElement("div",null,t[0].map((function(e,t){return r.a.createElement("span",{key:t,className:e},e)}))),r.a.createElement("span",null,t[1].map((function(e,t){return r.a.createElement("span",{key:t,className:e},e)}))),r.a.createElement("div",null,t[2].map((function(e,t){return r.a.createElement("span",{key:t,className:e},e)}))))}return r.a.createElement("td",Object.assign({},e.getCellProps(),{className:"table-cell"}),e.render("Cell"))})))})))),r.a.createElement(u.a,{className:"pagination"},r.a.createElement(j.a,{className:"page-controls",sm:12,md:4},r.a.createElement(m.a,{variant:"light",onClick:function(){return O(0)},disabled:!h},"<<"),r.a.createElement(m.a,{variant:"light",onClick:function(){return _()},disabled:!h},"<"),r.a.createElement(m.a,{variant:"light",onClick:function(){return w()},disabled:!b},">"),r.a.createElement(m.a,{variant:"light",onClick:function(){return O(y-1)},disabled:!b},">>"),r.a.createElement("p",null," ","Page ",r.a.createElement("strong",null,C+1," ")," of"," ",r.a.createElement("strong",null,E.length))),r.a.createElement(j.a,{className:"manual-page-selection",sm:12,md:4},r.a.createElement(Y.a,null,r.a.createElement(Y.a.Prepend,null,r.a.createElement(Y.a.Text,{id:"page-info"},"Go to page:")),r.a.createElement(s.a.Control,{type:"number",defaultValue:C+1,onChange:function(e){var t=e.target.value?Number(e.target.value)-1:0;O(t)},"aria-label":"Go To Page","aria-describedby":"page-info"}))),r.a.createElement(j.a,{className:"results-per-page",sm:12,md:4},r.a.createElement(s.a.Control,{value:F,onChange:function(e){S(Number(e.target.value))},as:"select"},[10,20,30,40,50].map((function(e){return r.a.createElement("option",{key:e,value:e},"Show ",e)}))))),r.a.createElement(u.a,null,r.a.createElement(Q.CSVLink,{data:t,headers:n,filename:"sensitivity_miss.csv",className:"btn btn-dark",target:"_blank"},"Download Table")))},ne=(a(275),function(){var e=Object(g.f)();return r.a.createElement(d.a,null,r.a.createElement("p",{className:"no-data"},"Please make sure that you've uploaded some data first!"),r.a.createElement(m.a,{onClick:function(){return e.push("/")}},"Upload Data"))}),re=function(e){var t=e.results,a=r.a.useState([]),n=Object(o.a)(a,2),l=n[0],c=n[1],s=Object(g.h)().display.split("&");if(0!==Object.keys(t).length){var u=le(t)[0],m=function(e){console.log("making overview data");var t,a=[],n=le(e),r=Object(o.a)(n,2),l=r[0],c=r[1],s=Object(h.a)(c);try{var u=function(){var n=t.value,r=e[n],c=Object.keys(l);a.push.apply(a,Object(i.a)(c.map((function(e){return{date:new Date(e),name:n,mutation_pct:r.filter((function(t){return t.date===e})).length/l[e].total*100,mutation3_pct:r.filter((function(t){return t.date===e&&0!==parseInt(t.misses3)})).length/l[e].total*100}}))))};for(s.s();!(t=s.n()).done;)u()}catch(m){s.e(m)}finally{s.f()}return a}(t),f=m.reduce((function(e,t){return e.includes(t.name)||e.push(t.name),e}),[]),p=function(e,t,a){function n(e){return function(t){return t.primer=e,t}}var r,l="Overview"!==t[0]?t:le(e)[1],c=[],o=function(e,t){if(1===t.length)return new Set;for(var a=e[t[0]],n=1;n<t.length;n++)a=ce(a,e[t[n]]);return new Set(a.map((function(e){return e.accession_id})))}(e,l),s=Object(h.a)(l);try{for(s.s();!(r=s.n()).done;){var u=r.value;c.push.apply(c,Object(i.a)(e[u].filter((function(e){return!o.has(e.accession_id)})).map(n(u))))}}catch(m){s.e(m)}finally{s.f()}return c}(t,s),v=function(e,t,a){var n=[],r=Object.keys(e);return n.push.apply(n,Object(i.a)(r.map((function(n){return{date:new Date(n),name:a.join(", "),total_mut_pct:t.filter((function(e){return e.date===n})).length/e[n].total*100,total_mut3_pct:t.filter((function(e){return e.date===n&&0!==parseInt(e.misses3)})).length/e[n].total*100}})))),n}(u,p,f),b=p.filter(oe(l));return r.a.createElement("div",{className:"display-page"},r.a.createElement(d.a,null,r.a.createElement(P,{displayOptions:Object.keys(t),resultToDisplay:s}),r.a.createElement(K,{toDisplay:s,overviewData:m,combinedOverview:v,mapData:b,dbCount:u,timeFrameBrush:l,setTimeFrameBrush:c}),r.a.createElement(ae,{data:b})))}return r.a.createElement(ne,null)};function le(e){var t=Object.keys(e);return[e[t[t.length-1]],t.slice(0,t.length-1)]}function ce(e,t){var a,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.filter((a=new Set(t.map((function(e){return e.accession_id}))),function(e){return n===a.has(e.accession_id)}));return r}var oe=function(e){return function(t){var a=new Date(t.date),n=!0;if(0!==e.length){var r=Object(o.a)(e,2),l=r[0],c=r[1];n=a>=new Date(l)&&a<=new Date(c)}return n}};var ie=function(){var e=Object(n.useState)({}),t=Object(o.a)(e,2),a=t[0],l=t[1];return r.a.createElement(M.a,{basename:"/METHODS/corona/gamma/primer/build"},r.a.createElement(M.b,{to:"/",style:{textDecoration:"none"}},r.a.createElement("h1",{className:"title"},"Primer Checker")),r.a.createElement(g.c,null,r.a.createElement(g.a,{exact:!0,path:"/"},r.a.createElement(D,{setResults:l})),r.a.createElement(g.a,{exact:!0,path:"/results/:display"},r.a.createElement(re,{results:a})),r.a.createElement(g.a,{path:"/results"},r.a.createElement(re,{results:a})),r.a.createElement(g.a,{path:"/"},r.a.createElement("div",null,"404: Page not found"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[199,1,2]]]);
//# sourceMappingURL=main.bcc68ce6.chunk.js.map