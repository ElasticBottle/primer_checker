!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://mendel3.bii.a-star.edu.sg/METHODS/corona/gamma/primer/build/",n(n.s=0)}([function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function o(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=a(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){u=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw o}}}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(s){a=!0,o=s}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.r(e),n.d(e,"filterTable",(function(){return m})),n.d(e,"getTotalSubmission",(function(){return p})),n.d(e,"getLineGraphData",(function(){return y})),n.d(e,"getCombinedLineData",(function(){return h})),n.d(e,"makeBarData",(function(){return _})),n.d(e,"makeIntersection",(function(){return D}));function s(t){return function(e){return e.primer=t,e}}var c=function(t){var e=t.timeFrameBrush,n=void 0===e?[]:e,r=t.primers,a=void 0===r?[]:r,o=t.pType,i=void 0===o?[]:o,s=t.countries,c=void 0===s?[]:s,m=t.miss,l=void 0===m?[]:m,f=t.miss3,d=void 0===f?[]:f,p=t.match,v=void 0===p?[]:p;return function(t){var e=!0,r=!0,o=!0,s=!0,m=!0,f=!0,p=!0;if(0!==n.length){var b=new Date(t.date),g=u(n,2),y=g[0],h=g[1];e=b.getTime()>=new Date(y).getTime()&&b.getTime()<=new Date(h).getTime()}return 0!==a.length&&(r=a.includes(t.primer)),0!==i.length&&(o=i.includes(t.type)),0!==c.length&&(s=c.map((function(t){return t.label})).includes(t.country_name)),0!==l.length&&(m=t.misses>=(l[0]||0)&&t.misses<=(l[1]||100)),0!==d.length&&(f=t.misses3>=(d[0]||0)&&t.misses3<=(d[1]||100)),0!==v.length&&(p=t.match_pct>=(v[0]||0)&&t.match_pct<=(v[1]||100)),e&&r&&o&&s&&m&&f&&p}};function m(t){var e=t.baseTableData,n=t.timeFrameBrush,r=void 0===n?[]:n,a=t.primers,o=void 0===a?[]:a,i=t.pType,u=void 0===i?[]:i,s=t.countries,m=void 0===s?[]:s,l=t.miss,f=void 0===l?[]:l,d=t.miss3,p=void 0===d?[]:d,v=t.match,b=void 0===v?[]:v;return e.filter(c({primers:o,pType:u,countries:m,miss:f,miss3:p,match:b,timeFrameBrush:r}))}function l(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r={},a=0,o=Object.keys(e);a<o.length;a++){var i=o[a];r[i]=(t[i]||n)+e[i]}return r}function f(t,e){for(var n={},r=0,a=Object.keys(e);r<a.length;r++){var o=a[r];n[o]=t[o]-e[o]}return n}function d(t,e,n){return 0===e.length?t[n].total:e.reduce((function(e,r){return e+=t[n][r.value]||0}),0)}function p(t){var e=t.dbDaily,n=t.dbCum,r=t.dateRange,a=t.countries,o=t.countryAsTotal,u=t.useCum,s=t.lookBack,c=t.separate,m=void 0!==c&&c;if(u){for(var p={},v=0,b=Object.keys(n);v<b.length;v++){var g=b[v];p[g]=o?d(n,a,g):n[g].total}return p}var y=function(t,e,n){var r=new Date(n[0]),a=new Date(r),o=new Date(n[n.length-1]);a.setDate(a.getDate()+e);var i=r.toISOString().slice(0,10),u={};u[i]=JSON.parse(JSON.stringify(t[i])),r.setDate(r.getDate()+1);for(var s=r;s<=a;s.setDate(s.getDate()+1)){var c=s.toISOString().slice(0,10),m=new Date(s);m.setDate(m.getDate()-1),m=m.toISOString().slice(0,10),u[c]=l(u[m],t[c]||{})}a.setDate(a.getDate()+1);for(var d=a;d<=o;d.setDate(d.getDate()+1)){var p=d.toISOString().slice(0,10),v=new Date(d);v.setDate(v.getDate()-1);var b=new Date(v);b.setDate(b.getDate()-e),v=v.toISOString().slice(0,10),b=b.toISOString().slice(0,10),u[p]=l(f(u[v],t[b]),t[p]||{})}return u}(e,s,r);if(m)return y;var h,_=i(r);try{for(_.s();!(h=_.n()).done;){var S=h.value;y[S]=o?d(y,a,S):y[S].total}}catch(D){_.e(D)}finally{_.f()}return y}function v(t,e,n){if("add"===t){var r=e.mutation_abs+n.mutation_abs,a=e.mutation3_abs+n.mutation3_abs;return{name:e.name,date:e.date,mutation3_abs:a,mutation3_pct:a/e.submission_count*100,mutation_abs:r,mutation_pct:r/e.submission_count*100,submission_count:e.submission_count,countries_considered:e.countries_considered,lookBack:e.lookBack}}if("subtract"===t){var o=e.mutation_abs-n.mutation_abs,i=e.mutation3_abs-n.mutation3_abs;return{name:e.name,date:e.date,mutation3_abs:i,mutation3_pct:i/e.submission_count*100,mutation_abs:o,mutation_pct:o/e.submission_count*100,submission_count:e.submission_count,countries_considered:e.countries_considered,lookBack:e.lookBack}}throw'invalid f, expected "add" or "subtract", got '.concat(t)}function b(t,e){var n=[];if(n.push({name:t[0].name,date:t[0].date,mutation3_abs:t[0].mutation3_abs,mutation3_pct:t[0].mutation3_abs/t[0].submission_count*100,mutation_abs:t[0].mutation_abs,mutation_pct:t[0].mutation_abs/t[0].submission_count*100,submission_count:t[0].submission_count,countries_considered:t[0].countries,lookBack:t[0].lookBack}),-1===e)for(var r=1;r<t.length;r++)n.push(v("add",t[r],n[r-1]));else{for(var a=1;a<=e;a++)n.push(v("add",t[a],n[a-1]));for(var o=e+1;o<t.length;o++)n.push(v("add",t[o],v("subtract",n[o-1],t[o-1-e])))}return n}function g(t){var e,n=t.toPlot,r=t.primers,a=t.dateRange,o=t.pType,u=t.countries,s=t.miss,m=t.miss3,l=t.match,f=t.totalSubmission,d=t.useCum,p=t.lookBack,v=[],g=i(r);try{var y=function(){var t=e.value;v.push(a.map((function(e){var r=(n[t][e]||[]).reduce((function(t,e){return c({pType:o,countries:u,miss:s,miss3:m,match:l})(e)&&(t[0].add(e.virus_name),e.misses3>=1&&t[1].add(e.virus_name)),t}),[new Set,new Set]);return{name:t,date:e,mutation3_abs:r[1].size,mutation3_pct:0,mutation_abs:r[0].size,mutation_pct:0,submission_count:f[e],countries_considered:u,lookBack:d?-1:p}})))};for(g.s();!(e=g.n()).done;)y()}catch(h){g.e(h)}finally{g.f()}return d?v.map((function(t){return b(t,-1)})):v.map((function(t){return b(t,p)}))}function y(t){for(var e=t.baseData,n=t.dateRange,r=t.primers,a=t.pType,o=t.countries,i=t.miss,u=t.miss3,s=t.match,c=t.totalSubmission,m=t.useCum,l=t.lookBack,f={},d=function(){var t=v[p];(0===r.length||r.find((function(e){return e===t})))&&(f[t]=e[t])},p=0,v=Object.keys(e);p<v.length;p++)d();return g({toPlot:f,primers:0===r.length?Object.keys(e):r,dateRange:n,pType:a,countries:o,miss:i,miss3:u,match:s,totalSubmission:c,useCum:m,lookBack:l})}function h(t,e,n,r,a,o,i,u,s,c,m){return g({toPlot:t,primers:e,dateRange:n,pType:r,countries:a,miss:o,miss3:i,match:u,totalSubmission:s,useCum:c,lookBack:m})}function _(t){var e=t.graphOverview,n=t.dates,r=t.timeFrameBrush,a=t.daysBetweenComparison,i=t.numberOfBars,u=[],s=r[1]||new Date(n[n.length-1]),c=new Date(s);for(c.setDate(c.getDate()-a*i);c.getTime()<new Date(n[0]);)c.setDate(c.getDate()+a);for(var m=function(t){for(var n=[],r=0;r<e.length;r++){var a=e[r].filter((function(e){return e.date===t.toISOString().slice(0,10)}));n.push.apply(n,o(a))}u.push(n)},l=c;l<=s;l.setDate(l.getDate()+a))m(l);return u}function S(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(n){var a=t.filter((o=new Set(e.map((function(t){return t[n]}))),function(t){return r===o.has(t[n])}));return a}var o,i=t.filter(function(t){return function(e){return r===t.has(e)}}(new Set(e.map((function(t){return t})))));return i}function D(t,e){var n=[];if(e.length>1){var r=e.join(", ");return[n=(n=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"accession_id",n=t[0],r=1;r<t.length;r++)n=S(n,t[r],e);return n}(Object.values(t))).map(s(r)),[r]]}return[n,""]}addEventListener("message",(function(t){var n,r=t.data,a=r.type,o=r.method,i=r.id,u=r.params;"RPC"===a&&o&&((n=e[o])?Promise.resolve().then((function(){return n.apply(e,u)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:i,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:i,error:e})}))})),postMessage({type:"RPC",method:"ready"})}]);
//# sourceMappingURL=9960ed1363f938047f59.worker.js.map